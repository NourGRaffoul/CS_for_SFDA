
cuda is not avaiable.

==================================================
goal = test
device = cpu
device_id = 0
dataset = HAR
num_classes = 6
model = CNN
batch_size = 10
local_learning_rate = 0.01
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 60
top_cnt = 100
local_epochs = 10
algorithm = FedAvg
join_ratio = 0.25
random_join_ratio = False
num_clients = 20
prev = 0
times = 1
eval_gap = 1
save_folder_name = items
auto_break = False
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 80
max_len = 200
few_shot = 0
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.0
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 1.0
plocal_epochs = 1
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 0.1
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.1
kl_weight = 0.0
num_candidates = 10
method = RandomSelect
comment = NRC
num_clients_per_round = 5
num_available = None
loss_div_sqrt = False
loss_sum = False
subset_ratio = 0.1
alpha1 = 0.75
alpha2 = 1
alpha3 = 0.1
save_probs = False
no_save_results = False
src_id = 1
imbalance_factor = 10.0
total_num_clients = 20
num_epoch = 10
wandb = True
==================================================

****** Client source: 1 *******
Accuracy of source client: 97.80%

============= Running time: 0th =============
Creating server and clients ...
CNN
Initializing client selection method: RandomSelect
Pre-loading and preparing all client data...
INFO: Simulating imbalance with factor 10.0 for client 0 training data.
INFO: Simulating imbalance with factor 10.0 for client 1 training data.
INFO: Simulating imbalance with factor 10.0 for client 2 training data.
INFO: Simulating imbalance with factor 10.0 for client 3 training data.
INFO: Simulating imbalance with factor 10.0 for client 4 training data.
INFO: Simulating imbalance with factor 10.0 for client 5 training data.
INFO: Simulating imbalance with factor 10.0 for client 6 training data.
INFO: Simulating imbalance with factor 10.0 for client 7 training data.
INFO: Simulating imbalance with factor 10.0 for client 8 training data.
INFO: Simulating imbalance with factor 10.0 for client 9 training data.
INFO: Simulating imbalance with factor 10.0 for client 10 training data.
INFO: Simulating imbalance with factor 10.0 for client 11 training data.
INFO: Simulating imbalance with factor 10.0 for client 12 training data.
INFO: Simulating imbalance with factor 10.0 for client 13 training data.
INFO: Simulating imbalance with factor 10.0 for client 14 training data.
INFO: Simulating imbalance with factor 10.0 for client 15 training data.
INFO: Simulating imbalance with factor 10.0 for client 16 training data.
INFO: Simulating imbalance with factor 10.0 for client 17 training data.
INFO: Simulating imbalance with factor 10.0 for client 18 training data.
INFO: Simulating imbalance with factor 10.0 for client 19 training data.
Data loading complete.

Join ratio / total clients: 0.25 / 20
Finished creating server and clients.

------------- Round 0-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 6  3  1 10 19]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 0.8225
Averaged Test Accurancy: 0.7609
Averaged Test AUC: 0.8797
Std Test Accurancy: 0.1663
Std Test AUC: 0.0932
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 3, 6, 10, 19]
------------------------- time cost ------------------------- 199.5268268585205

------------- Round 1-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [12 10  5 17  3]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.2082
Averaged Test Accurancy: 0.5350
Averaged Test AUC: 0.8219
Std Test Accurancy: 0.2190
Std Test AUC: 0.1066
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 5, 10, 12, 17]
------------------------- time cost ------------------------- 199.1688826084137

------------- Round 2-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16  9  3  7  6]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.3960
Averaged Test Accurancy: 0.3843
Averaged Test AUC: 0.7059
Std Test Accurancy: 0.1589
Std Test AUC: 0.1067
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 6, 7, 9, 16]
------------------------- time cost ------------------------- 206.6324667930603

------------- Round 3-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 8 11 13  9  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.4539
Averaged Test Accurancy: 0.2284
Averaged Test AUC: 0.6565
Std Test Accurancy: 0.1175
Std Test AUC: 0.0792
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [7, 8, 9, 11, 13]
------------------------- time cost ------------------------- 195.12049841880798

------------- Round 4-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 9 14  6  2  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.5774
Averaged Test Accurancy: 0.2365
Averaged Test AUC: 0.6250
Std Test Accurancy: 0.1401
Std Test AUC: 0.0699
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 6, 7, 9, 14]
------------------------- time cost ------------------------- 180.4327347278595

------------- Round 5-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [18  4 11  2  6]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.6687
Averaged Test Accurancy: 0.2218
Averaged Test AUC: 0.5873
Std Test Accurancy: 0.1014
Std Test AUC: 0.0583
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 4, 6, 11, 18]
------------------------- time cost ------------------------- 173.3049876689911

------------- Round 6-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17 19  7 11  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.6735
Averaged Test Accurancy: 0.2751
Averaged Test AUC: 0.5904
Std Test Accurancy: 0.0525
Std Test AUC: 0.0358
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [7, 9, 11, 17, 19]
------------------------- time cost ------------------------- 201.97908186912537

------------- Round 7-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [10 16 11 15  5]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.6640
Averaged Test Accurancy: 0.2497
Averaged Test AUC: 0.5426
Std Test Accurancy: 0.0534
Std Test AUC: 0.0380
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 10, 11, 15, 16]
------------------------- time cost ------------------------- 202.3671751022339

------------- Round 8-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15  4 12  3  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.6708
Averaged Test Accurancy: 0.2503
Averaged Test AUC: 0.5713
Std Test Accurancy: 0.0484
Std Test AUC: 0.0376
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 4, 8, 12, 15]
------------------------- time cost ------------------------- 189.16493320465088

------------- Round 9-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 6 15  4  1  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.6788
Averaged Test Accurancy: 0.3579
Averaged Test AUC: 0.5902
Std Test Accurancy: 0.0675
Std Test AUC: 0.0488
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 4, 6, 7, 15]
------------------------- time cost ------------------------- 190.17862606048584

------------- Round 10-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [14 19 17 13  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.6768
Averaged Test Accurancy: 0.3751
Averaged Test AUC: 0.6602
Std Test Accurancy: 0.0588
Std Test AUC: 0.0422
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 13, 14, 17, 19]
------------------------- time cost ------------------------- 206.38194036483765

------------- Round 11-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [11  6 10 17 15]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.6788
Averaged Test Accurancy: 0.2721
Averaged Test AUC: 0.6214
Std Test Accurancy: 0.0726
Std Test AUC: 0.0286
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 10, 11, 15, 17]
------------------------- time cost ------------------------- 179.21967577934265

------------- Round 12-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [19 18  6  2 14]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.6834
Averaged Test Accurancy: 0.2766
Averaged Test AUC: 0.5958
Std Test Accurancy: 0.0778
Std Test AUC: 0.0309
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 6, 14, 18, 19]
------------------------- time cost ------------------------- 184.42513275146484

------------- Round 13-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 7  8 10  4  0]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7963
Averaged Test Accurancy: 0.3152
Averaged Test AUC: 0.6011
Std Test Accurancy: 0.0632
Std Test AUC: 0.0305
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 4, 7, 8, 10]
------------------------- time cost ------------------------- 187.29904174804688

------------- Round 14-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 6  2  9  1 10]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7957
Averaged Test Accurancy: 0.1817
Averaged Test AUC: 0.5488
Std Test Accurancy: 0.0420
Std Test AUC: 0.0293
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 2, 6, 9, 10]
------------------------- time cost ------------------------- 169.60456085205078

------------- Round 15-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 5  0  2 18  6]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7966
Averaged Test Accurancy: 0.2305
Averaged Test AUC: 0.5442
Std Test Accurancy: 0.0594
Std Test AUC: 0.0373
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 2, 5, 6, 18]
------------------------- time cost ------------------------- 217.11227750778198

------------- Round 16-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 6  8 18  3 15]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7945
Averaged Test Accurancy: 0.3112
Averaged Test AUC: 0.4774
Std Test Accurancy: 0.0723
Std Test AUC: 0.0316
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 6, 8, 15, 18]
------------------------- time cost ------------------------- 189.8368194103241

------------- Round 17-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 9  5  7 11  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7947
Averaged Test Accurancy: 0.1056
Averaged Test AUC: 0.5266
Std Test Accurancy: 0.0556
Std Test AUC: 0.0350
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 7, 8, 9, 11]
------------------------- time cost ------------------------- 157.0472605228424

------------- Round 18-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [10 12  2  0  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7917
Averaged Test Accurancy: 0.1477
Averaged Test AUC: 0.5287
Std Test Accurancy: 0.0281
Std Test AUC: 0.0217
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 2, 9, 10, 12]
------------------------- time cost ------------------------- 211.75034999847412

------------- Round 19-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [11  8 15 10  6]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7919
Averaged Test Accurancy: 0.0807
Averaged Test AUC: 0.5571
Std Test Accurancy: 0.0865
Std Test AUC: 0.0241
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 8, 10, 11, 15]
------------------------- time cost ------------------------- 175.73197317123413

------------- Round 20-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17  8 12 18 13]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7915
Averaged Test Accurancy: 0.1904
Averaged Test AUC: 0.5115
Std Test Accurancy: 0.0669
Std Test AUC: 0.0285
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [8, 12, 13, 17, 18]
------------------------- time cost ------------------------- 173.3299674987793

------------- Round 21-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 5 10 17  2 13]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7913
Averaged Test Accurancy: 0.1746
Averaged Test AUC: 0.5425
Std Test Accurancy: 0.0290
Std Test AUC: 0.0246
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 5, 10, 13, 17]
------------------------- time cost ------------------------- 181.13902735710144

------------- Round 22-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15 14 17  4  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7907
Averaged Test Accurancy: 0.1995
Averaged Test AUC: 0.5541
Std Test Accurancy: 0.0288
Std Test AUC: 0.0227
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 4, 14, 15, 17]
------------------------- time cost ------------------------- 183.81534337997437

------------- Round 23-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 7 18 10  2  3]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7919
Averaged Test Accurancy: 0.1838
Averaged Test AUC: 0.5371
Std Test Accurancy: 0.0201
Std Test AUC: 0.0096
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 3, 7, 10, 18]
------------------------- time cost ------------------------- 171.20603442192078

------------- Round 24-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [13  1 11 12  6]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7922
Averaged Test Accurancy: 0.1838
Averaged Test AUC: 0.5645
Std Test Accurancy: 0.0201
Std Test AUC: 0.0266
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 6, 11, 12, 13]
------------------------- time cost ------------------------- 171.4285101890564

------------- Round 25-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 6  1  2 12  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7905
Averaged Test Accurancy: 0.1609
Averaged Test AUC: 0.5477
Std Test Accurancy: 0.0196
Std Test AUC: 0.0129
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 2, 6, 7, 12]
------------------------- time cost ------------------------- 164.45483136177063

------------- Round 26-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 0 18 17 14 15]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7929
Averaged Test Accurancy: 0.0959
Averaged Test AUC: 0.5299
Std Test Accurancy: 0.0625
Std Test AUC: 0.0252
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 14, 15, 17, 18]
------------------------- time cost ------------------------- 248.10462498664856

------------- Round 27-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [10  2 14  8  0]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7927
Averaged Test Accurancy: 0.1665
Averaged Test AUC: 0.5056
Std Test Accurancy: 0.0165
Std Test AUC: 0.0257
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 2, 8, 10, 14]
------------------------- time cost ------------------------- 250.10287261009216

------------- Round 28-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [14 10  1 13 18]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7910
Averaged Test Accurancy: 0.1746
Averaged Test AUC: 0.4967
Std Test Accurancy: 0.0290
Std Test AUC: 0.0158
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 10, 13, 14, 18]
------------------------- time cost ------------------------- 209.41101384162903

------------- Round 29-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [13  3 18  9  4]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7913
Averaged Test Accurancy: 0.1807
Averaged Test AUC: 0.4702
Std Test Accurancy: 0.0213
Std Test AUC: 0.0198
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 4, 9, 13, 18]
------------------------- time cost ------------------------- 179.34768748283386

------------- Round 30-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 3 12  8 17  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7923
Averaged Test Accurancy: 0.1411
Averaged Test AUC: 0.4387
Std Test Accurancy: 0.0111
Std Test AUC: 0.0220
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 3, 8, 12, 17]
------------------------- time cost ------------------------- 172.08640575408936

------------- Round 31-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [11  0  1 16  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7937
Averaged Test Accurancy: 0.1665
Averaged Test AUC: 0.4754
Std Test Accurancy: 0.0165
Std Test AUC: 0.0354
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 1, 9, 11, 16]
------------------------- time cost ------------------------- 224.24338340759277

------------- Round 32-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 4 17 14  9 11]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7925
Averaged Test Accurancy: 0.0701
Averaged Test AUC: 0.5261
Std Test Accurancy: 0.0636
Std Test AUC: 0.0132
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 9, 11, 14, 17]
------------------------- time cost ------------------------- 175.88649344444275

------------- Round 33-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [10 12  3 19 16]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7934
Averaged Test Accurancy: 0.0239
Averaged Test AUC: 0.4263
Std Test Accurancy: 0.0483
Std Test AUC: 0.0391
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 10, 12, 16, 19]
------------------------- time cost ------------------------- 197.81844830513

------------- Round 34-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [18  4 11 12  0]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7927
Averaged Test Accurancy: 0.0183
Averaged Test AUC: 0.4405
Std Test Accurancy: 0.0396
Std Test AUC: 0.0337
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 4, 11, 12, 18]
------------------------- time cost ------------------------- 217.62528681755066

------------- Round 35-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16 12 14  6 15]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7925
Averaged Test Accurancy: 0.1792
Averaged Test AUC: 0.4763
Std Test Accurancy: 0.0306
Std Test AUC: 0.0206
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 12, 14, 15, 16]
------------------------- time cost ------------------------- 147.13566827774048

------------- Round 36-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 2 12 19  7 11]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7911
Averaged Test Accurancy: 0.1665
Averaged Test AUC: 0.4625
Std Test Accurancy: 0.0165
Std Test AUC: 0.0120
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 7, 11, 12, 19]
------------------------- time cost ------------------------- 111.7206392288208

------------- Round 37-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 7 11  0 19  5]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7921
Averaged Test Accurancy: 0.1411
Averaged Test AUC: 0.4786
Std Test Accurancy: 0.0111
Std Test AUC: 0.0131
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 5, 7, 11, 19]
------------------------- time cost ------------------------- 146.9742352962494

------------- Round 38-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 4  3  2 19 12]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7923
Averaged Test Accurancy: 0.0259
Averaged Test AUC: 0.4234
Std Test Accurancy: 0.0420
Std Test AUC: 0.0410
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 3, 4, 12, 19]
------------------------- time cost ------------------------- 112.19290113449097

------------- Round 39-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16 14  4  1  6]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7928
Averaged Test Accurancy: 0.1376
Averaged Test AUC: 0.3896
Std Test Accurancy: 0.0127
Std Test AUC: 0.0250
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 4, 6, 14, 16]
------------------------- time cost ------------------------- 118.23906469345093

------------- Round 40-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 9 14 16  4 13]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7924
Averaged Test Accurancy: 0.2848
Averaged Test AUC: 0.4712
Std Test Accurancy: 0.0429
Std Test AUC: 0.0175
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 9, 13, 14, 16]
------------------------- time cost ------------------------- 127.44315004348755

------------- Round 41-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [13  8 19 17 12]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7927
Averaged Test Accurancy: 0.1807
Averaged Test AUC: 0.5499
Std Test Accurancy: 0.0213
Std Test AUC: 0.0146
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [8, 12, 13, 17, 19]
------------------------- time cost ------------------------- 129.4829273223877

------------- Round 42-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 9 12 11  2 19]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7919
Averaged Test Accurancy: 0.1533
Averaged Test AUC: 0.4154
Std Test Accurancy: 0.0155
Std Test AUC: 0.0161
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 9, 11, 12, 19]
------------------------- time cost ------------------------- 122.01171493530273

------------- Round 43-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 4 18  8 12  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7923
Averaged Test Accurancy: 0.1807
Averaged Test AUC: 0.4407
Std Test Accurancy: 0.0213
Std Test AUC: 0.0176
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 8, 9, 12, 18]
------------------------- time cost ------------------------- 124.5571231842041

------------- Round 44-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 6  2 17  5 19]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7915
Averaged Test Accurancy: 0.1533
Averaged Test AUC: 0.4166
Std Test Accurancy: 0.0155
Std Test AUC: 0.0191
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 5, 6, 17, 19]
------------------------- time cost ------------------------- 148.59346437454224

------------- Round 45-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15  8  5  9  0]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7911
Averaged Test Accurancy: 0.1746
Averaged Test AUC: 0.4760
Std Test Accurancy: 0.0290
Std Test AUC: 0.0292
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 5, 8, 9, 15]
------------------------- time cost ------------------------- 161.99462938308716

------------- Round 46-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15 12 10 11  0]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7923
Averaged Test Accurancy: 0.0010
Averaged Test AUC: 0.4365
Std Test Accurancy: 0.0033
Std Test AUC: 0.0345
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 10, 11, 12, 15]
------------------------- time cost ------------------------- 210.39530229568481

------------- Round 47-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 9  7 19  3  5]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7923
Averaged Test Accurancy: 0.1746
Averaged Test AUC: 0.4206
Std Test Accurancy: 0.0290
Std Test AUC: 0.0206
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 5, 7, 9, 19]
------------------------- time cost ------------------------- 123.7590560913086

------------- Round 48-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 4  2 14  9 17]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7907
Averaged Test Accurancy: 0.1853
Averaged Test AUC: 0.5158
Std Test Accurancy: 0.0393
Std Test AUC: 0.0185
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 4, 9, 14, 17]
------------------------- time cost ------------------------- 131.45676612854004

------------- Round 49-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16 14 17  5  3]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7929
Averaged Test Accurancy: 0.0020
Averaged Test AUC: 0.3798
Std Test Accurancy: 0.0052
Std Test AUC: 0.0223
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 5, 14, 16, 17]
------------------------- time cost ------------------------- 192.5119912624359

------------- Round 50-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 2 17  0  1 11]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7924
Averaged Test Accurancy: 0.1406
Averaged Test AUC: 0.4380
Std Test Accurancy: 0.0108
Std Test AUC: 0.0185
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 1, 2, 11, 17]
------------------------- time cost ------------------------- 199.36163902282715

------------- Round 51-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 2 15 10  1 18]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7915
Averaged Test Accurancy: 0.2376
Averaged Test AUC: 0.4800
Std Test Accurancy: 0.0500
Std Test AUC: 0.0134
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 2, 10, 15, 18]
------------------------- time cost ------------------------- 153.0215404033661

------------- Round 52-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [19  8  1 13  0]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7918
Averaged Test Accurancy: 0.1533
Averaged Test AUC: 0.4566
Std Test Accurancy: 0.0155
Std Test AUC: 0.0141
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 1, 8, 13, 19]
------------------------- time cost ------------------------- 200.79805493354797

------------- Round 53-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 1 16 17 15 18]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7945
Averaged Test Accurancy: 0.0447
Averaged Test AUC: 0.3671
Std Test Accurancy: 0.0252
Std Test AUC: 0.0140
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 15, 16, 17, 18]
------------------------- time cost ------------------------- 202.3135209083557

------------- Round 54-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 4  0  1 11  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7942
Averaged Test Accurancy: 0.1396
Averaged Test AUC: 0.3887
Std Test Accurancy: 0.0107
Std Test AUC: 0.0191
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 1, 4, 8, 11]
------------------------- time cost ------------------------- 267.6841869354248

------------- Round 55-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 3  0  6 16  5]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7927
Averaged Test Accurancy: 0.0299
Averaged Test AUC: 0.3949
Std Test Accurancy: 0.0232
Std Test AUC: 0.0205
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 3, 5, 6, 16]
------------------------- time cost ------------------------- 281.55467200279236

------------- Round 56-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 3 18 17  2  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7929
Averaged Test Accurancy: 0.1665
Averaged Test AUC: 0.3932
Std Test Accurancy: 0.0165
Std Test AUC: 0.0135
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 3, 7, 17, 18]
------------------------- time cost ------------------------- 185.44033002853394

------------- Round 57-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [3 0 1 9 8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7919
Averaged Test Accurancy: 0.1264
Averaged Test AUC: 0.3881
Std Test Accurancy: 0.0167
Std Test AUC: 0.0123
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 1, 3, 8, 9]
------------------------- time cost ------------------------- 203.98138785362244

------------- Round 58-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 5  9  8 10 18]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7924
Averaged Test Accurancy: 0.1132
Averaged Test AUC: 0.3629
Std Test Accurancy: 0.0213
Std Test AUC: 0.0118
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 8, 9, 10, 18]
------------------------- time cost ------------------------- 190.07150435447693

------------- Round 59-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [13 11 15  8  4]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7917
Averaged Test Accurancy: 0.1533
Averaged Test AUC: 0.4315
Std Test Accurancy: 0.0155
Std Test AUC: 0.0184
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 8, 11, 13, 15]
------------------------- time cost ------------------------- 245.77011275291443

------------- Round 60-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [19 17  9  6 12]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7937
Averaged Test Accurancy: 0.1411
Averaged Test AUC: 0.3761
Std Test Accurancy: 0.0111
Std Test AUC: 0.0088
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 9, 12, 17, 19]
------------------------- time cost ------------------------- 387.88208746910095

Average time cost: nans.
Length:  101
std for best accurancy: 0.0
mean for best accurancy: 0.9165861513687601
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 31062674 	Used Memory: 118.72M
-------------------------------------------------------------------------------
