
cuda is not avaiable.

==================================================
goal = test
device = cpu
device_id = 0
dataset = HAR
num_classes = 6
model = CNN
batch_size = 10
local_learning_rate = 0.01
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 60
top_cnt = 100
local_epochs = 10
algorithm = FedAvg
join_ratio = 0.25
random_join_ratio = False
num_clients = 20
prev = 0
times = 1
eval_gap = 1
save_folder_name = items
auto_break = False
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 80
max_len = 200
few_shot = 0
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.0
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 1.0
plocal_epochs = 1
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 0.1
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.1
kl_weight = 0.0
num_candidates = 10
method = RandomSelect
comment =
num_clients_per_round = 5
num_available = None
loss_div_sqrt = False
loss_sum = False
subset_ratio = 0.1
alpha1 = 0.75
alpha2 = 1
alpha3 = 0.1
save_probs = False
no_save_results = False
src_id = 1
imbalance_factor = 100.0
total_num_clients = 20
num_epoch = 10
wandb = True
==================================================

****** Client source: 1 *******
Accuracy of source client: 97.80%

============= Running time: 0th =============
Creating server and clients ...
CNN
Initializing client selection method: RandomSelect
Pre-loading and preparing all client data...
INFO: Simulating imbalance with factor 100.0 for client 0 training data.
INFO: Simulating imbalance with factor 100.0 for client 1 training data.
INFO: Simulating imbalance with factor 100.0 for client 2 training data.
INFO: Simulating imbalance with factor 100.0 for client 3 training data.
INFO: Simulating imbalance with factor 100.0 for client 4 training data.
INFO: Simulating imbalance with factor 100.0 for client 5 training data.
INFO: Simulating imbalance with factor 100.0 for client 6 training data.
INFO: Simulating imbalance with factor 100.0 for client 7 training data.
INFO: Simulating imbalance with factor 100.0 for client 8 training data.
INFO: Simulating imbalance with factor 100.0 for client 9 training data.
INFO: Simulating imbalance with factor 100.0 for client 10 training data.
INFO: Simulating imbalance with factor 100.0 for client 11 training data.
INFO: Simulating imbalance with factor 100.0 for client 12 training data.
INFO: Simulating imbalance with factor 100.0 for client 13 training data.
INFO: Simulating imbalance with factor 100.0 for client 14 training data.
INFO: Simulating imbalance with factor 100.0 for client 15 training data.
INFO: Simulating imbalance with factor 100.0 for client 16 training data.
INFO: Simulating imbalance with factor 100.0 for client 17 training data.
INFO: Simulating imbalance with factor 100.0 for client 18 training data.
INFO: Simulating imbalance with factor 100.0 for client 19 training data.
Data loading complete.

Join ratio / total clients: 0.25 / 20
Finished creating server and clients.

------------- Round 0-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16  4  5 13 15]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 0.8154
Averaged Test Accurancy: 0.7609
Averaged Test AUC: 0.8797
Std Test Accurancy: 0.1663
Std Test AUC: 0.0932
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 5, 13, 15, 16]
------------------------- time cost ------------------------- 100.70100474357605

------------- Round 1-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [11  9 15 16  4]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 0.6518
Averaged Test Accurancy: 0.6589
Averaged Test AUC: 0.8754
Std Test Accurancy: 0.1126
Std Test AUC: 0.0754
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 9, 11, 15, 16]
------------------------- time cost ------------------------- 91.08760046958923

------------- Round 2-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 0 18  7 19  5]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.0808
Averaged Test Accurancy: 0.4924
Averaged Test AUC: 0.7919
Std Test Accurancy: 0.1369
Std Test AUC: 0.0668
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 5, 7, 18, 19]
------------------------- time cost ------------------------- 100.271164894104

------------- Round 3-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 6  7 14 18 12]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.6901
Averaged Test Accurancy: 0.4249
Averaged Test AUC: 0.6867
Std Test Accurancy: 0.1731
Std Test AUC: 0.1394
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 7, 12, 14, 18]
------------------------- time cost ------------------------- 99.10124087333679

------------- Round 4-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17 18  7  3 16]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.4609
Averaged Test Accurancy: 0.4959
Averaged Test AUC: 0.7335
Std Test Accurancy: 0.1263
Std Test AUC: 0.0824
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 7, 16, 17, 18]
------------------------- time cost ------------------------- 95.74639582633972

------------- Round 5-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [14  0 12 18  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.2691
Averaged Test Accurancy: 0.4614
Averaged Test AUC: 0.6984
Std Test Accurancy: 0.1145
Std Test AUC: 0.0573
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 7, 12, 14, 18]
------------------------- time cost ------------------------- 108.05205178260803

------------- Round 6-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17 19  6  1  5]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.2203
Averaged Test Accurancy: 0.4497
Averaged Test AUC: 0.7106
Std Test Accurancy: 0.0958
Std Test AUC: 0.0470
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 5, 6, 17, 19]
------------------------- time cost ------------------------- 98.16701865196228

------------- Round 7-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 2  5  0  8 13]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.5316
Averaged Test Accurancy: 0.3706
Averaged Test AUC: 0.6777
Std Test Accurancy: 0.1526
Std Test AUC: 0.1254
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 2, 5, 8, 13]
------------------------- time cost ------------------------- 99.80619978904724

------------- Round 8-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 5 10 14 12  6]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.4214
Averaged Test Accurancy: 0.3604
Averaged Test AUC: 0.6395
Std Test Accurancy: 0.0685
Std Test AUC: 0.0568
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 6, 10, 12, 14]
------------------------- time cost ------------------------- 92.37017059326172

------------- Round 9-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 2 19  0 11 15]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.0870
Averaged Test Accurancy: 0.4452
Averaged Test AUC: 0.7599
Std Test Accurancy: 0.0913
Std Test AUC: 0.0592
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 2, 11, 15, 19]
------------------------- time cost ------------------------- 104.22534584999084

------------- Round 10-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 1 17 15  7  2]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0843
Averaged Test Accurancy: 0.3843
Averaged Test AUC: 0.6868
Std Test Accurancy: 0.0895
Std Test AUC: 0.0620
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 2, 7, 15, 17]
------------------------- time cost ------------------------- 89.81060123443604

------------- Round 11-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [12  5  1  8 10]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.4578
Averaged Test Accurancy: 0.4376
Averaged Test AUC: 0.6824
Std Test Accurancy: 0.1364
Std Test AUC: 0.1059
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 5, 8, 10, 12]
------------------------- time cost ------------------------- 90.60496401786804

------------- Round 12-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [11  6  8 14 16]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 9.9252
Averaged Test Accurancy: 0.2157
Averaged Test AUC: 0.5565
Std Test Accurancy: 0.1700
Std Test AUC: 0.1151
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 8, 11, 14, 16]
------------------------- time cost ------------------------- 95.00900077819824

------------- Round 13-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 9 12 14 17  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.1159
Averaged Test Accurancy: 0.4279
Averaged Test AUC: 0.7241
Std Test Accurancy: 0.1131
Std Test AUC: 0.0660
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 9, 12, 14, 17]
------------------------- time cost ------------------------- 112.83701086044312

------------- Round 14-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [10  7  4  3 13]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0491
Averaged Test Accurancy: 0.3213
Averaged Test AUC: 0.6924
Std Test Accurancy: 0.0673
Std Test AUC: 0.0743
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 4, 7, 10, 13]
------------------------- time cost ------------------------- 100.39419889450073

------------- Round 15-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15  2 10 19 17]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.1121
Averaged Test Accurancy: 0.3954
Averaged Test AUC: 0.6633
Std Test Accurancy: 0.0634
Std Test AUC: 0.0542
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 10, 15, 17, 19]
------------------------- time cost ------------------------- 109.3067512512207

------------- Round 16-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 2  3  4 12 19]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.1792
Averaged Test Accurancy: 0.4655
Averaged Test AUC: 0.7334
Std Test Accurancy: 0.1335
Std Test AUC: 0.0691
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 3, 4, 12, 19]
------------------------- time cost ------------------------- 107.43146133422852

------------- Round 17-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 6 15  3 19  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9675
Averaged Test Accurancy: 0.3010
Averaged Test AUC: 0.6352
Std Test Accurancy: 0.0755
Std Test AUC: 0.0594
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 6, 9, 15, 19]
------------------------- time cost ------------------------- 96.93348217010498

------------- Round 18-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 1  3 19  5 12]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 8.4743
Averaged Test Accurancy: 0.2665
Averaged Test AUC: 0.5688
Std Test Accurancy: 0.1971
Std Test AUC: 0.1366
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 3, 5, 12, 19]
------------------------- time cost ------------------------- 111.11944770812988

------------- Round 19-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 3 10  1  2 11]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.5697
Averaged Test Accurancy: 0.3863
Averaged Test AUC: 0.6620
Std Test Accurancy: 0.0988
Std Test AUC: 0.0617
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 2, 3, 10, 11]
------------------------- time cost ------------------------- 111.48030424118042

------------- Round 20-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 2 11  6  3 15]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.6538
Averaged Test Accurancy: 0.3178
Averaged Test AUC: 0.5649
Std Test Accurancy: 0.1608
Std Test AUC: 0.1020
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 3, 6, 11, 15]
------------------------- time cost ------------------------- 106.16454100608826

------------- Round 21-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 0  7 16  6 12]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.3098
Averaged Test Accurancy: 0.3838
Averaged Test AUC: 0.7220
Std Test Accurancy: 0.1185
Std Test AUC: 0.0661
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 6, 7, 12, 16]
------------------------- time cost ------------------------- 116.11550855636597

------------- Round 22-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [7 8 1 0 5]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.3278
Averaged Test Accurancy: 0.4208
Averaged Test AUC: 0.6695
Std Test Accurancy: 0.1225
Std Test AUC: 0.0552
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 1, 5, 7, 8]
------------------------- time cost ------------------------- 151.65410137176514

------------- Round 23-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 3 12 10  8 19]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 12.6623
Averaged Test Accurancy: 0.2360
Averaged Test AUC: 0.5182
Std Test Accurancy: 0.1656
Std Test AUC: 0.1140
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 8, 10, 12, 19]
------------------------- time cost ------------------------- 119.09299993515015

------------- Round 24-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [14  0 18 11  3]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0059
Averaged Test Accurancy: 0.2751
Averaged Test AUC: 0.6293
Std Test Accurancy: 0.0757
Std Test AUC: 0.0616
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 3, 11, 14, 18]
------------------------- time cost ------------------------- 114.67222547531128

------------- Round 25-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [19 15  0 11  4]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 17.4554
Averaged Test Accurancy: 0.1254
Averaged Test AUC: 0.4286
Std Test Accurancy: 0.1376
Std Test AUC: 0.1055
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 4, 11, 15, 19]
------------------------- time cost ------------------------- 125.05615854263306

------------- Round 26-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 0 19 15 17  4]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 11.4397
Averaged Test Accurancy: 0.2376
Averaged Test AUC: 0.5640
Std Test Accurancy: 0.1620
Std Test AUC: 0.1189
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 4, 15, 17, 19]
------------------------- time cost ------------------------- 120.04537749290466

------------- Round 27-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 3 18 17  0 19]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 7.1085
Averaged Test Accurancy: 0.2254
Averaged Test AUC: 0.5649
Std Test Accurancy: 0.1538
Std Test AUC: 0.0929
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 3, 17, 18, 19]
------------------------- time cost ------------------------- 122.89160013198853

------------- Round 28-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 3  2 19  7 16]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.5732
Averaged Test Accurancy: 0.2863
Averaged Test AUC: 0.6158
Std Test Accurancy: 0.0964
Std Test AUC: 0.0551
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 3, 7, 16, 19]
------------------------- time cost ------------------------- 107.73735737800598

------------- Round 29-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [19 17 13 10 16]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 4.3550
Averaged Test Accurancy: 0.3355
Averaged Test AUC: 0.5966
Std Test Accurancy: 0.1097
Std Test AUC: 0.0588
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [10, 13, 16, 17, 19]
------------------------- time cost ------------------------- 100.1819052696228

------------- Round 30-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 5 14 19  0  3]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.5219
Averaged Test Accurancy: 0.3645
Averaged Test AUC: 0.6151
Std Test Accurancy: 0.1225
Std Test AUC: 0.0576
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 3, 5, 14, 19]
------------------------- time cost ------------------------- 102.89408349990845

------------- Round 31-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 7  3 12  1 19]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 25.0212
Averaged Test Accurancy: 0.1173
Averaged Test AUC: 0.4312
Std Test Accurancy: 0.1329
Std Test AUC: 0.1018
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 3, 7, 12, 19]
------------------------- time cost ------------------------- 91.82258605957031

------------- Round 32-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [19 11 13 10 16]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8308
Averaged Test Accurancy: 0.2670
Averaged Test AUC: 0.6011
Std Test Accurancy: 0.0928
Std Test AUC: 0.0873
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [10, 11, 13, 16, 19]
------------------------- time cost ------------------------- 91.06777119636536

------------- Round 33-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 9 12 18  1  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.6057
Averaged Test Accurancy: 0.3462
Averaged Test AUC: 0.5973
Std Test Accurancy: 0.1171
Std Test AUC: 0.0638
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 7, 9, 12, 18]
------------------------- time cost ------------------------- 89.33976435661316

------------- Round 34-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17 14  7  4 15]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.0238
Averaged Test Accurancy: 0.4244
Averaged Test AUC: 0.6914
Std Test Accurancy: 0.1187
Std Test AUC: 0.0590
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 7, 14, 15, 17]
------------------------- time cost ------------------------- 89.4509482383728

------------- Round 35-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 5 19  1  3 16]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9230
Averaged Test Accurancy: 0.3376
Averaged Test AUC: 0.6071
Std Test Accurancy: 0.1040
Std Test AUC: 0.0686
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 3, 5, 16, 19]
------------------------- time cost ------------------------- 90.90817975997925

------------- Round 36-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 1 15  9  4 10]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 4.4948
Averaged Test Accurancy: 0.3315
Averaged Test AUC: 0.5912
Std Test Accurancy: 0.1010
Std Test AUC: 0.0616
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 4, 9, 10, 15]
------------------------- time cost ------------------------- 88.7944974899292

------------- Round 37-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 9  0 13  5  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 21.7855
Averaged Test Accurancy: 0.1635
Averaged Test AUC: 0.4968
Std Test Accurancy: 0.1316
Std Test AUC: 0.0901
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 5, 7, 9, 13]
------------------------- time cost ------------------------- 96.36328053474426

------------- Round 38-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 3 19  1 12 11]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.0197
Averaged Test Accurancy: 0.4223
Averaged Test AUC: 0.6690
Std Test Accurancy: 0.1096
Std Test AUC: 0.0689
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 3, 11, 12, 19]
------------------------- time cost ------------------------- 88.45020008087158

------------- Round 39-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [13  3  0  8  6]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 4.4254
Averaged Test Accurancy: 0.2904
Averaged Test AUC: 0.5628
Std Test Accurancy: 0.1486
Std Test AUC: 0.0936
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 3, 6, 8, 13]
------------------------- time cost ------------------------- 95.8236882686615

------------- Round 40-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 7 12 10  5 14]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.6842
Averaged Test Accurancy: 0.3777
Averaged Test AUC: 0.6468
Std Test Accurancy: 0.1259
Std Test AUC: 0.0921
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 7, 10, 12, 14]
------------------------- time cost ------------------------- 85.0516996383667

------------- Round 41-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [12 11 13  8  0]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 18.6562
Averaged Test Accurancy: 0.1701
Averaged Test AUC: 0.5114
Std Test Accurancy: 0.1515
Std Test AUC: 0.0992
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 8, 11, 12, 13]
------------------------- time cost ------------------------- 97.09335494041443

------------- Round 42-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [10 16  7  5 18]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 5.6452
Averaged Test Accurancy: 0.3345
Averaged Test AUC: 0.6327
Std Test Accurancy: 0.1395
Std Test AUC: 0.1039
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 7, 10, 16, 18]
------------------------- time cost ------------------------- 92.02643632888794

------------- Round 43-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [12  9 10 14 15]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.4212
Averaged Test Accurancy: 0.2888
Averaged Test AUC: 0.6402
Std Test Accurancy: 0.1236
Std Test AUC: 0.0870
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [9, 10, 12, 14, 15]
------------------------- time cost ------------------------- 89.55189275741577

------------- Round 44-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [19  0  6 16 18]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9707
Averaged Test Accurancy: 0.3030
Averaged Test AUC: 0.6630
Std Test Accurancy: 0.1229
Std Test AUC: 0.0879
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 6, 16, 18, 19]
------------------------- time cost ------------------------- 107.91969108581543

------------- Round 45-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [11  7 14 12  4]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.3690
Averaged Test Accurancy: 0.3299
Averaged Test AUC: 0.6515
Std Test Accurancy: 0.1451
Std Test AUC: 0.1115
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 7, 11, 12, 14]
------------------------- time cost ------------------------- 84.67978763580322

------------- Round 46-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 3 14 19  2  6]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 6.1907
Averaged Test Accurancy: 0.2162
Averaged Test AUC: 0.5348
Std Test Accurancy: 0.1403
Std Test AUC: 0.0976
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 3, 6, 14, 19]
------------------------- time cost ------------------------- 88.59555721282959

------------- Round 47-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 8 14 18  0 11]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.7627
Averaged Test Accurancy: 0.3426
Averaged Test AUC: 0.6468
Std Test Accurancy: 0.1144
Std Test AUC: 0.0912
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 8, 11, 14, 18]
------------------------- time cost ------------------------- 98.48524522781372

------------- Round 48-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [13 19 18  5  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 5.2479
Averaged Test Accurancy: 0.2467
Averaged Test AUC: 0.5534
Std Test Accurancy: 0.1232
Std Test AUC: 0.0837
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 7, 13, 18, 19]
------------------------- time cost ------------------------- 87.03647041320801

------------- Round 49-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 1 12  0  7  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.5095
Averaged Test Accurancy: 0.3975
Averaged Test AUC: 0.7259
Std Test Accurancy: 0.1017
Std Test AUC: 0.0669
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 1, 7, 9, 12]
------------------------- time cost ------------------------- 96.06321024894714

------------- Round 50-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [14 19  7  8  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 6.2665
Averaged Test Accurancy: 0.1756
Averaged Test AUC: 0.5095
Std Test Accurancy: 0.1397
Std Test AUC: 0.1344
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 7, 8, 14, 19]
------------------------- time cost ------------------------- 81.85436534881592

------------- Round 51-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 3  4  2 13  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.1754
Averaged Test Accurancy: 0.2924
Averaged Test AUC: 0.6284
Std Test Accurancy: 0.0863
Std Test AUC: 0.0924
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 2, 3, 4, 13]
------------------------- time cost ------------------------- 87.20275330543518

------------- Round 52-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [12 15  5  6  4]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8797
Averaged Test Accurancy: 0.3061
Averaged Test AUC: 0.6881
Std Test Accurancy: 0.0952
Std Test AUC: 0.0945
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 5, 6, 12, 15]
------------------------- time cost ------------------------- 87.29103446006775

------------- Round 53-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 1 16 13 12  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 4.7513
Averaged Test Accurancy: 0.2294
Averaged Test AUC: 0.5118
Std Test Accurancy: 0.1375
Std Test AUC: 0.1164
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 7, 12, 13, 16]
------------------------- time cost ------------------------- 98.66269516944885

------------- Round 54-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 5 13 17 11  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.5935
Averaged Test Accurancy: 0.4076
Averaged Test AUC: 0.6830
Std Test Accurancy: 0.1074
Std Test AUC: 0.0635
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 8, 11, 13, 17]
------------------------- time cost ------------------------- 113.80070114135742

------------- Round 55-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15 14  0  2 17]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.5772
Averaged Test Accurancy: 0.2437
Averaged Test AUC: 0.5363
Std Test Accurancy: 0.1278
Std Test AUC: 0.1080
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 2, 14, 15, 17]
------------------------- time cost ------------------------- 150.02611351013184

------------- Round 56-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 7 16 11  0 13]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0546
Averaged Test Accurancy: 0.3604
Averaged Test AUC: 0.6970
Std Test Accurancy: 0.1220
Std Test AUC: 0.1004
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 7, 11, 13, 16]
------------------------- time cost ------------------------- 127.41386151313782

------------- Round 57-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16 10 15 18 14]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 4.3704
Averaged Test Accurancy: 0.3584
Averaged Test AUC: 0.6252
Std Test Accurancy: 0.0640
Std Test AUC: 0.0355
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [10, 14, 15, 16, 18]
------------------------- time cost ------------------------- 100.07591772079468

------------- Round 58-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 0 11 13 17 18]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 11.2250
Averaged Test Accurancy: 0.1751
Averaged Test AUC: 0.4734
Std Test Accurancy: 0.1530
Std Test AUC: 0.1067
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 11, 13, 17, 18]
------------------------- time cost ------------------------- 110.80282282829285

------------- Round 59-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [19  9  5 13  6]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.3526
Averaged Test Accurancy: 0.3244
Averaged Test AUC: 0.6864
Std Test Accurancy: 0.1233
Std Test AUC: 0.0750
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 6, 9, 13, 19]
------------------------- time cost ------------------------- 134.95051765441895

------------- Round 60-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17  8  0 12 16]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.5243
Averaged Test Accurancy: 0.3685
Averaged Test AUC: 0.7120
Std Test Accurancy: 0.1213
Std Test AUC: 0.0855
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 8, 12, 16, 17]
------------------------- time cost ------------------------- 163.7706208229065

Average time cost: nans.
Length:  101
std for best accurancy: 0.0
mean for best accurancy: 0.9165861513687601
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 6425953 	Used Memory: 24.55M
-------------------------------------------------------------------------------
