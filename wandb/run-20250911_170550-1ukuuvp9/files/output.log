
cuda is not avaiable.

==================================================
goal = test
device = cpu
device_id = 0
dataset = HAR
num_classes = 6
model = CNN
batch_size = 10
local_learning_rate = 0.01
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 60
top_cnt = 100
local_epochs = 10
algorithm = FedAvg
join_ratio = 0.25
random_join_ratio = False
num_clients = 20
prev = 0
times = 1
eval_gap = 1
save_folder_name = items
auto_break = False
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 80
max_len = 200
few_shot = 0
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.0
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 1.0
plocal_epochs = 1
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 0.1
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.1
kl_weight = 0.0
num_candidates = 10
method = RandomSelect
comment = NRC
num_clients_per_round = 5
num_available = None
loss_div_sqrt = False
loss_sum = False
subset_ratio = 0.1
alpha1 = 0.75
alpha2 = 1
alpha3 = 0.1
save_probs = False
no_save_results = False
src_id = 1
imbalance_factor = 50.0
total_num_clients = 20
num_epoch = 10
wandb = True
==================================================

****** Client source: 1 *******
Accuracy of source client: 97.80%

============= Running time: 0th =============
Creating server and clients ...
CNN
Initializing client selection method: RandomSelect
Pre-loading and preparing all client data...
INFO: Simulating imbalance with factor 50.0 for client 0 training data.
INFO: Simulating imbalance with factor 50.0 for client 1 training data.
INFO: Simulating imbalance with factor 50.0 for client 2 training data.
INFO: Simulating imbalance with factor 50.0 for client 3 training data.
INFO: Simulating imbalance with factor 50.0 for client 4 training data.
INFO: Simulating imbalance with factor 50.0 for client 5 training data.
INFO: Simulating imbalance with factor 50.0 for client 6 training data.
INFO: Simulating imbalance with factor 50.0 for client 7 training data.
INFO: Simulating imbalance with factor 50.0 for client 8 training data.
INFO: Simulating imbalance with factor 50.0 for client 9 training data.
INFO: Simulating imbalance with factor 50.0 for client 10 training data.
INFO: Simulating imbalance with factor 50.0 for client 11 training data.
INFO: Simulating imbalance with factor 50.0 for client 12 training data.
INFO: Simulating imbalance with factor 50.0 for client 13 training data.
INFO: Simulating imbalance with factor 50.0 for client 14 training data.
INFO: Simulating imbalance with factor 50.0 for client 15 training data.
INFO: Simulating imbalance with factor 50.0 for client 16 training data.
INFO: Simulating imbalance with factor 50.0 for client 17 training data.
INFO: Simulating imbalance with factor 50.0 for client 18 training data.
INFO: Simulating imbalance with factor 50.0 for client 19 training data.
Data loading complete.

Join ratio / total clients: 0.25 / 20
Finished creating server and clients.

------------- Round 0-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 9 14  8  5 15]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 0.8139
Averaged Test Accurancy: 0.7609
Averaged Test AUC: 0.8797
Std Test Accurancy: 0.1663
Std Test AUC: 0.0932
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 8, 9, 14, 15]
------------------------- time cost ------------------------- 236.12882447242737

------------- Round 1-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 4 15  8  3 19]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 0.9006
Averaged Test Accurancy: 0.7680
Averaged Test AUC: 0.8861
Std Test Accurancy: 0.1596
Std Test AUC: 0.1064
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 4, 8, 15, 19]
------------------------- time cost ------------------------- 289.82339549064636

------------- Round 2-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [18 13  7  9  4]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.0854
Averaged Test Accurancy: 0.6599
Averaged Test AUC: 0.8622
Std Test Accurancy: 0.1536
Std Test AUC: 0.1131
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 7, 9, 13, 18]
------------------------- time cost ------------------------- 220.61699676513672

------------- Round 3-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [12  9  3  7  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.2366
Averaged Test Accurancy: 0.5249
Averaged Test AUC: 0.8126
Std Test Accurancy: 0.1416
Std Test AUC: 0.1151
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 3, 7, 9, 12]
------------------------- time cost ------------------------- 135.7014377117157

------------- Round 4-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [18 11 10 12  0]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.4725
Averaged Test Accurancy: 0.4066
Averaged Test AUC: 0.7797
Std Test Accurancy: 0.1453
Std Test AUC: 0.1063
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 10, 11, 12, 18]
------------------------- time cost ------------------------- 181.37627243995667

------------- Round 5-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [19 16 13 10  6]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.6000
Averaged Test Accurancy: 0.3152
Averaged Test AUC: 0.7225
Std Test Accurancy: 0.1021
Std Test AUC: 0.0841
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 10, 13, 16, 19]
------------------------- time cost ------------------------- 148.68793725967407

------------- Round 6-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [14  2  0  4  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.6862
Averaged Test Accurancy: 0.4376
Averaged Test AUC: 0.7572
Std Test Accurancy: 0.0974
Std Test AUC: 0.0895
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 1, 2, 4, 14]
------------------------- time cost ------------------------- 164.08049964904785

------------- Round 7-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [11  1  2  6 13]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.6867
Averaged Test Accurancy: 0.4442
Averaged Test AUC: 0.7597
Std Test Accurancy: 0.1127
Std Test AUC: 0.0750
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 2, 6, 11, 13]
------------------------- time cost ------------------------- 143.31399846076965

------------- Round 8-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [10 15 14 13 19]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.6910
Averaged Test Accurancy: 0.4350
Averaged Test AUC: 0.7258
Std Test Accurancy: 0.0966
Std Test AUC: 0.0703
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [10, 13, 14, 15, 19]
------------------------- time cost ------------------------- 151.7693932056427

------------- Round 9-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [13  0 16  5  3]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7058
Averaged Test Accurancy: 0.3822
Averaged Test AUC: 0.7322
Std Test Accurancy: 0.0646
Std Test AUC: 0.0725
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 3, 5, 13, 16]
------------------------- time cost ------------------------- 159.1114857196808

------------- Round 10-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [18  0  5 15 13]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7076
Averaged Test Accurancy: 0.3731
Averaged Test AUC: 0.6562
Std Test Accurancy: 0.0792
Std Test AUC: 0.0694
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 5, 13, 15, 18]
------------------------- time cost ------------------------- 150.58413934707642

------------- Round 11-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [19  2  3 11  0]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7104
Averaged Test Accurancy: 0.4426
Averaged Test AUC: 0.6583
Std Test Accurancy: 0.0898
Std Test AUC: 0.0697
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 2, 3, 11, 19]
------------------------- time cost ------------------------- 161.0300362110138

------------- Round 12-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 2 18  4  7  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7163
Averaged Test Accurancy: 0.4117
Averaged Test AUC: 0.6178
Std Test Accurancy: 0.0946
Std Test AUC: 0.0555
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 2, 4, 7, 18]
------------------------- time cost ------------------------- 135.2651562690735

------------- Round 13-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 7 15 11  5  0]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7129
Averaged Test Accurancy: 0.4284
Averaged Test AUC: 0.6481
Std Test Accurancy: 0.0873
Std Test AUC: 0.0574
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 5, 7, 11, 15]
------------------------- time cost ------------------------- 147.20736742019653

------------- Round 14-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 2 17 12 15 14]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7858
Averaged Test Accurancy: 0.2381
Averaged Test AUC: 0.6666
Std Test Accurancy: 0.0781
Std Test AUC: 0.0668
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 12, 14, 15, 17]
------------------------- time cost ------------------------- 151.02479648590088

------------- Round 15-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [12  7 19 13  5]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7842
Averaged Test Accurancy: 0.3203
Averaged Test AUC: 0.5647
Std Test Accurancy: 0.0590
Std Test AUC: 0.0297
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 7, 12, 13, 19]
------------------------- time cost ------------------------- 148.1826024055481

------------- Round 16-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 8 15  0  9 13]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7908
Averaged Test Accurancy: 0.2107
Averaged Test AUC: 0.5672
Std Test Accurancy: 0.0546
Std Test AUC: 0.0301
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 8, 9, 13, 15]
------------------------- time cost ------------------------- 155.99701690673828

------------- Round 17-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16  5 10 18  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7916
Averaged Test Accurancy: 0.2183
Averaged Test AUC: 0.6360
Std Test Accurancy: 0.0562
Std Test AUC: 0.0310
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 9, 10, 16, 18]
------------------------- time cost ------------------------- 141.56899285316467

------------- Round 18-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [11 16  3 13 15]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7892
Averaged Test Accurancy: 0.0868
Averaged Test AUC: 0.6636
Std Test Accurancy: 0.0795
Std Test AUC: 0.0415
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 11, 13, 15, 16]
------------------------- time cost ------------------------- 157.92714285850525

------------- Round 19-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [14 15 17  8  3]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7927
Averaged Test Accurancy: 0.3152
Averaged Test AUC: 0.6730
Std Test Accurancy: 0.0680
Std Test AUC: 0.0511
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 8, 14, 15, 17]
------------------------- time cost ------------------------- 129.18811678886414

------------- Round 20-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 9  2  5 16  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7923
Averaged Test Accurancy: 0.2193
Averaged Test AUC: 0.5720
Std Test Accurancy: 0.0486
Std Test AUC: 0.0309
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 2, 5, 9, 16]
------------------------- time cost ------------------------- 155.60170769691467

------------- Round 21-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [14 19  7 10 17]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7949
Averaged Test Accurancy: 0.1812
Averaged Test AUC: 0.6195
Std Test Accurancy: 0.0208
Std Test AUC: 0.0374
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [7, 10, 14, 17, 19]
------------------------- time cost ------------------------- 133.19928431510925

------------- Round 22-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16 13 10 12 14]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7908
Averaged Test Accurancy: 0.2914
Averaged Test AUC: 0.5703
Std Test Accurancy: 0.0680
Std Test AUC: 0.0271
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [10, 12, 13, 14, 16]
------------------------- time cost ------------------------- 155.12747883796692

------------- Round 23-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [11 16  5 17  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7900
Averaged Test Accurancy: 0.2914
Averaged Test AUC: 0.6067
Std Test Accurancy: 0.0648
Std Test AUC: 0.0245
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 7, 11, 16, 17]
------------------------- time cost ------------------------- 149.51571583747864

------------- Round 24-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [19  1 11 15 16]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7926
Averaged Test Accurancy: 0.2635
Averaged Test AUC: 0.6348
Std Test Accurancy: 0.0639
Std Test AUC: 0.0362
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 11, 15, 16, 19]
------------------------- time cost ------------------------- 157.04068565368652

------------- Round 25-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [13 12  1 16  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7885
Averaged Test Accurancy: 0.2995
Averaged Test AUC: 0.5873
Std Test Accurancy: 0.0324
Std Test AUC: 0.0238
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 9, 12, 13, 16]
------------------------- time cost ------------------------- 157.76056027412415

------------- Round 26-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16  3 11  0 13]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7890
Averaged Test Accurancy: 0.1863
Averaged Test AUC: 0.5500
Std Test Accurancy: 0.0454
Std Test AUC: 0.0183
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 3, 11, 13, 16]
------------------------- time cost ------------------------- 169.22899556159973

------------- Round 27-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 8  2 12 16  0]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7910
Averaged Test Accurancy: 0.1447
Averaged Test AUC: 0.5003
Std Test Accurancy: 0.0302
Std Test AUC: 0.0229
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 2, 8, 12, 16]
------------------------- time cost ------------------------- 187.53570175170898

------------- Round 28-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [5 0 2 9 7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7894
Averaged Test Accurancy: 0.1838
Averaged Test AUC: 0.5441
Std Test Accurancy: 0.0201
Std Test AUC: 0.0153
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 2, 5, 7, 9]
------------------------- time cost ------------------------- 159.95712971687317

------------- Round 29-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17  5 18 15  2]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7912
Averaged Test Accurancy: 0.0447
Averaged Test AUC: 0.5487
Std Test Accurancy: 0.0520
Std Test AUC: 0.0241
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 5, 15, 17, 18]
------------------------- time cost ------------------------- 182.61089205741882

------------- Round 30-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 0  1 11  8  3]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7901
Averaged Test Accurancy: 0.1838
Averaged Test AUC: 0.5152
Std Test Accurancy: 0.0201
Std Test AUC: 0.0164
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 1, 3, 8, 11]
------------------------- time cost ------------------------- 178.18815684318542

------------- Round 31-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [12  4 16 13 14]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7944
Averaged Test Accurancy: 0.1706
Averaged Test AUC: 0.4476
Std Test Accurancy: 0.0320
Std Test AUC: 0.0389
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 12, 13, 14, 16]
------------------------- time cost ------------------------- 169.17237043380737

------------- Round 32-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [14  9 16 18 17]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7909
Averaged Test Accurancy: 0.1721
Averaged Test AUC: 0.5006
Std Test Accurancy: 0.0342
Std Test AUC: 0.0328
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [9, 14, 16, 17, 18]
------------------------- time cost ------------------------- 144.22634434700012

------------- Round 33-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17 11  6 10  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7915
Averaged Test Accurancy: 0.1807
Averaged Test AUC: 0.5154
Std Test Accurancy: 0.0213
Std Test AUC: 0.0185
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 6, 10, 11, 17]
------------------------- time cost ------------------------- 152.53530740737915

------------- Round 34-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 0 14  2  9  3]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7907
Averaged Test Accurancy: 0.1305
Averaged Test AUC: 0.4692
Std Test Accurancy: 0.0526
Std Test AUC: 0.0442
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 2, 3, 9, 14]
------------------------- time cost ------------------------- 173.14901781082153

------------- Round 35-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 3  1  8 14 17]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7909
Averaged Test Accurancy: 0.1746
Averaged Test AUC: 0.4626
Std Test Accurancy: 0.0290
Std Test AUC: 0.0365
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 3, 8, 14, 17]
------------------------- time cost ------------------------- 159.3930139541626

------------- Round 36-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 9  0  1  6 13]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7917
Averaged Test Accurancy: 0.0152
Averaged Test AUC: 0.4234
Std Test Accurancy: 0.0388
Std Test AUC: 0.0445
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 1, 6, 9, 13]
------------------------- time cost ------------------------- 162.05914855003357

------------- Round 37-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 3 18 13 19  0]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7921
Averaged Test Accurancy: 0.0315
Averaged Test AUC: 0.4173
Std Test Accurancy: 0.0615
Std Test AUC: 0.0309
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 3, 13, 18, 19]
------------------------- time cost ------------------------- 178.46121907234192

------------- Round 38-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 0 15 18  4 10]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7967
Averaged Test Accurancy: 0.1406
Averaged Test AUC: 0.4146
Std Test Accurancy: 0.0108
Std Test AUC: 0.0271
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 4, 10, 15, 18]
------------------------- time cost ------------------------- 179.05596280097961

------------- Round 39-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 4 17  0  1  6]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7940
Averaged Test Accurancy: 0.1746
Averaged Test AUC: 0.4773
Std Test Accurancy: 0.0290
Std Test AUC: 0.0300
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 1, 4, 6, 17]
------------------------- time cost ------------------------- 162.26733803749084

------------- Round 40-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15 12 17 13  6]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7939
Averaged Test Accurancy: 0.0071
Averaged Test AUC: 0.4166
Std Test Accurancy: 0.0270
Std Test AUC: 0.0361
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 12, 13, 15, 17]
------------------------- time cost ------------------------- 167.66416239738464

------------- Round 41-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 0 10 17 11  6]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7942
Averaged Test Accurancy: 0.0147
Averaged Test AUC: 0.4685
Std Test Accurancy: 0.0374
Std Test AUC: 0.0339
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 6, 10, 11, 17]
------------------------- time cost ------------------------- 188.4600110054016

------------- Round 42-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [13 14 11  9  2]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7925
Averaged Test Accurancy: 0.1746
Averaged Test AUC: 0.4888
Std Test Accurancy: 0.0290
Std Test AUC: 0.0272
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 9, 11, 13, 14]
------------------------- time cost ------------------------- 159.88633060455322

------------- Round 43-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [1 3 9 4 5]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7911
Averaged Test Accurancy: 0.0091
Averaged Test AUC: 0.4426
Std Test Accurancy: 0.0416
Std Test AUC: 0.0326
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 3, 4, 5, 9]
------------------------- time cost ------------------------- 160.0185420513153

------------- Round 44-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16 11 15  1  0]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7900
Averaged Test Accurancy: 0.1944
Averaged Test AUC: 0.5033
Std Test Accurancy: 0.0525
Std Test AUC: 0.0330
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 1, 11, 15, 16]
------------------------- time cost ------------------------- 184.22033619880676

------------- Round 45-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [13 14  2  1  4]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7937
Averaged Test Accurancy: 0.0624
Averaged Test AUC: 0.4189
Std Test Accurancy: 0.0438
Std Test AUC: 0.0280
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 2, 4, 13, 14]
------------------------- time cost ------------------------- 163.6855058670044

------------- Round 46-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 7 10 11  5  3]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7930
Averaged Test Accurancy: 0.1244
Averaged Test AUC: 0.4094
Std Test Accurancy: 0.0188
Std Test AUC: 0.0236
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 5, 7, 10, 11]
------------------------- time cost ------------------------- 145.6652729511261

------------- Round 47-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 4 17 19 14 16]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7927
Averaged Test Accurancy: 0.1802
Averaged Test AUC: 0.4580
Std Test Accurancy: 0.0373
Std Test AUC: 0.0192
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 14, 16, 17, 19]
------------------------- time cost ------------------------- 166.76200890541077

------------- Round 48-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 6 13  2 12  0]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7917
Averaged Test Accurancy: 0.1782
Averaged Test AUC: 0.4905
Std Test Accurancy: 0.0342
Std Test AUC: 0.0336
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 2, 6, 12, 13]
------------------------- time cost ------------------------- 193.57925033569336

------------- Round 49-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 4  7 12 15  3]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7946
Averaged Test Accurancy: 0.1416
Averaged Test AUC: 0.4658
Std Test Accurancy: 0.0340
Std Test AUC: 0.0220
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 4, 7, 12, 15]
------------------------- time cost ------------------------- 164.1860077381134

------------- Round 50-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [18  3 19  8  5]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7932
Averaged Test Accurancy: 0.1665
Averaged Test AUC: 0.5070
Std Test Accurancy: 0.0165
Std Test AUC: 0.0226
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 5, 8, 18, 19]
------------------------- time cost ------------------------- 157.68580079078674

------------- Round 51-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 4 14  6  8  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7936
Averaged Test Accurancy: 0.1675
Averaged Test AUC: 0.5009
Std Test Accurancy: 0.0187
Std Test AUC: 0.0113
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 6, 8, 9, 14]
------------------------- time cost ------------------------- 124.26420879364014

------------- Round 52-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [12 15  4  3  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7916
Averaged Test Accurancy: 0.1665
Averaged Test AUC: 0.4609
Std Test Accurancy: 0.0165
Std Test AUC: 0.0260
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 4, 9, 12, 15]
------------------------- time cost ------------------------- 151.60136151313782

------------- Round 53-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 4 13  3 16  5]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7905
Averaged Test Accurancy: 0.1609
Averaged Test AUC: 0.4472
Std Test Accurancy: 0.0194
Std Test AUC: 0.0185
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 4, 5, 13, 16]
------------------------- time cost ------------------------- 168.6507785320282

------------- Round 54-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [12  0 17  6 11]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7948
Averaged Test Accurancy: 0.1665
Averaged Test AUC: 0.4457
Std Test Accurancy: 0.0165
Std Test AUC: 0.0171
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 6, 11, 12, 17]
------------------------- time cost ------------------------- 201.952490568161

------------- Round 55-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 1 17  2 18 13]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7914
Averaged Test Accurancy: 0.2096
Averaged Test AUC: 0.5454
Std Test Accurancy: 0.0582
Std Test AUC: 0.0277
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 2, 13, 17, 18]
------------------------- time cost ------------------------- 188.31651782989502

------------- Round 56-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 2  7 18 19  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7906
Averaged Test Accurancy: 0.1761
Averaged Test AUC: 0.5611
Std Test Accurancy: 0.0301
Std Test AUC: 0.0353
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 7, 9, 18, 19]
------------------------- time cost ------------------------- 166.40969014167786

------------- Round 57-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17 11  2  4 15]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7895
Averaged Test Accurancy: 0.0416
Averaged Test AUC: 0.4203
Std Test Accurancy: 0.0481
Std Test AUC: 0.0409
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 4, 11, 15, 17]
------------------------- time cost ------------------------- 156.3999674320221

------------- Round 58-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 8 14 15  1  4]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7902
Averaged Test Accurancy: 0.0056
Averaged Test AUC: 0.3999
Std Test Accurancy: 0.0269
Std Test AUC: 0.0322
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 4, 8, 14, 15]
------------------------- time cost ------------------------- 153.07993960380554

------------- Round 59-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [ 8  2 11  9  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7911
Averaged Test Accurancy: 0.0523
Averaged Test AUC: 0.3944
Std Test Accurancy: 0.0307
Std Test AUC: 0.0251
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 2, 8, 9, 11]
------------------------- time cost ------------------------- 153.3902084827423

------------- Round 60-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [11 17  6  9  5]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Distributing global model to 5 clients.
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.7908
Averaged Test Accurancy: 0.1898
Averaged Test AUC: 0.4523
Std Test Accurancy: 0.0244
Std Test AUC: 0.0211
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 6, 9, 11, 17]
------------------------- time cost ------------------------- 156.17516946792603

Average time cost: nans.
Length:  101
std for best accurancy: 0.0
mean for best accurancy: 0.9165861513687601
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 30313224 	Used Memory: 115.86M
-------------------------------------------------------------------------------
