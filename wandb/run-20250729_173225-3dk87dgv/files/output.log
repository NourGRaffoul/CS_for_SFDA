
cuda is not avaiable.

==================================================
goal = test
device = cpu
device_id = 0
dataset = HAR
num_classes = 6
model = HARCNN
batch_size = 10
local_learning_rate = 0.01
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 100
top_cnt = 100
local_epochs = 1
algorithm = FedAvg
join_ratio = 0.25
random_join_ratio = False
num_clients = 20
prev = 0
times = 1
eval_gap = 1
save_folder_name = items
auto_break = False
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 80
max_len = 200
few_shot = 0
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.0
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 1.0
plocal_epochs = 1
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 0.1
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.1
kl_weight = 0.0
num_candidates = 0
method = AFL
comment = IMB
num_clients_per_round = 5
num_available = None
loss_div_sqrt = False
loss_sum = False
subset_ratio = 0.1
alpha1 = 0.75
alpha2 = 1
alpha3 = 0.1
save_probs = False
no_save_results = False
src_id = 1
imbalance_factor = 50.0
total_num_clients = 20
num_epoch = 1
wandb = True
==================================================

****** Client source: 1 *******
Accuracy of source client: 97.80%

============= Running time: 0th =============
Creating server and clients ...
HARCNN
Initializing client selection method: AFL
Pre-loading and preparing all client data...
INFO: Simulating imbalance with factor 50.0 for client 0 training data.
INFO: Simulating imbalance with factor 50.0 for client 1 training data.
INFO: Simulating imbalance with factor 50.0 for client 2 training data.
INFO: Simulating imbalance with factor 50.0 for client 3 training data.
INFO: Simulating imbalance with factor 50.0 for client 4 training data.
INFO: Simulating imbalance with factor 50.0 for client 5 training data.
INFO: Simulating imbalance with factor 50.0 for client 6 training data.
INFO: Simulating imbalance with factor 50.0 for client 7 training data.
INFO: Simulating imbalance with factor 50.0 for client 8 training data.
INFO: Simulating imbalance with factor 50.0 for client 9 training data.
INFO: Simulating imbalance with factor 50.0 for client 10 training data.
INFO: Simulating imbalance with factor 50.0 for client 11 training data.
INFO: Simulating imbalance with factor 50.0 for client 12 training data.
INFO: Simulating imbalance with factor 50.0 for client 13 training data.
INFO: Simulating imbalance with factor 50.0 for client 14 training data.
INFO: Simulating imbalance with factor 50.0 for client 15 training data.
INFO: Simulating imbalance with factor 50.0 for client 16 training data.
INFO: Simulating imbalance with factor 50.0 for client 17 training data.
INFO: Simulating imbalance with factor 50.0 for client 18 training data.
INFO: Simulating imbalance with factor 50.0 for client 19 training data.
Data loading complete.

Join ratio / total clients: 0.25 / 20
Finished creating server and clients.

------------- Round 0-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 0.7977
Averaged Test Accurancy: 0.7574
Averaged Test AUC: 0.9162
Std Test Accurancy: 0.1784
Std Test AUC: 0.0833
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 8 14  2 13  1]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 2, 8, 13, 14]
------------------------- time cost ------------------------- 710.3390877246857

------------- Round 1-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.7059
Averaged Test Accurancy: 0.3614
Averaged Test AUC: 0.6283
Std Test Accurancy: 0.1481
Std Test AUC: 0.1338
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [18  3  8 19 15]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 8, 15, 18, 19]
------------------------- time cost ------------------------- 730.1559822559357

------------- Round 2-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.7719
Averaged Test Accurancy: 0.3569
Averaged Test AUC: 0.6718
Std Test Accurancy: 0.1158
Std Test AUC: 0.1019
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [6 4 7 3 5]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 4, 5, 6, 7]
------------------------- time cost ------------------------- 722.6243262290955

------------- Round 3-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.6943
Averaged Test Accurancy: 0.3497
Averaged Test AUC: 0.6588
Std Test Accurancy: 0.1316
Std Test AUC: 0.1074
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 1  5 15 17  8]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 5, 8, 15, 17]
------------------------- time cost ------------------------- 725.6707553863525

------------- Round 4-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.5724
Averaged Test Accurancy: 0.3863
Averaged Test AUC: 0.6549
Std Test Accurancy: 0.1197
Std Test AUC: 0.0959
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [16 13  3 11 10]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 10, 11, 13, 16]
------------------------- time cost ------------------------- 732.532154083252

------------- Round 5-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.4972
Averaged Test Accurancy: 0.3756
Averaged Test AUC: 0.7208
Std Test Accurancy: 0.1128
Std Test AUC: 0.1005
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [19 13  1  6 18]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 6, 13, 18, 19]
------------------------- time cost ------------------------- 790.9359540939331

------------- Round 6-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8947
Averaged Test Accurancy: 0.3594
Averaged Test AUC: 0.6668
Std Test Accurancy: 0.1203
Std Test AUC: 0.1034
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 3 19 17 18 13]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 13, 17, 18, 19]
------------------------- time cost ------------------------- 806.7474014759064

------------- Round 7-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0683
Averaged Test Accurancy: 0.3350
Averaged Test AUC: 0.7015
Std Test Accurancy: 0.1185
Std Test AUC: 0.0967
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [14 17  2  7 12]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 7, 12, 14, 17]
------------------------- time cost ------------------------- 783.9300374984741

------------- Round 8-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9971
Averaged Test Accurancy: 0.3426
Averaged Test AUC: 0.7233
Std Test Accurancy: 0.1228
Std Test AUC: 0.0919
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [10 15 11 17  6]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 10, 11, 15, 17]
------------------------- time cost ------------------------- 696.625762462616

------------- Round 9-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9724
Averaged Test Accurancy: 0.3558
Averaged Test AUC: 0.6936
Std Test Accurancy: 0.1147
Std Test AUC: 0.0830
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [16  6 13 14 11]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 11, 13, 14, 16]
------------------------- time cost ------------------------- 709.1490473747253

------------- Round 10-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9027
Averaged Test Accurancy: 0.3477
Averaged Test AUC: 0.6807
Std Test Accurancy: 0.1135
Std Test AUC: 0.0993
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [14  7 16  4 13]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 7, 13, 14, 16]
------------------------- time cost ------------------------- 674.7308940887451

------------- Round 11-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0071
Averaged Test Accurancy: 0.3690
Averaged Test AUC: 0.7255
Std Test Accurancy: 0.1074
Std Test AUC: 0.1016
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [15 16 14  5 19]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 14, 15, 16, 19]
------------------------- time cost ------------------------- 805.541318655014

------------- Round 12-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8195
Averaged Test Accurancy: 0.3640
Averaged Test AUC: 0.6853
Std Test Accurancy: 0.1110
Std Test AUC: 0.0937
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [14 13 17  4  2]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 4, 13, 14, 17]
------------------------- time cost ------------------------- 951.6854329109192

------------- Round 13-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9905
Averaged Test Accurancy: 0.3599
Averaged Test AUC: 0.7391
Std Test Accurancy: 0.1068
Std Test AUC: 0.0833
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 4  8  3  6 16]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 4, 6, 8, 16]
------------------------- time cost ------------------------- 729.6733708381653

------------- Round 14-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.7674
Averaged Test Accurancy: 0.3533
Averaged Test AUC: 0.7251
Std Test Accurancy: 0.1136
Std Test AUC: 0.0785
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [16 13  4 15  5]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 5, 13, 15, 16]
------------------------- time cost ------------------------- 828.6307282447815

------------- Round 15-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0737
Averaged Test Accurancy: 0.3254
Averaged Test AUC: 0.6613
Std Test Accurancy: 0.1098
Std Test AUC: 0.0988
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [14 11 17 12  0]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 11, 12, 14, 17]
------------------------- time cost ------------------------- 883.3639981746674

------------- Round 16-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9806
Averaged Test Accurancy: 0.3533
Averaged Test AUC: 0.7062
Std Test Accurancy: 0.1067
Std Test AUC: 0.0892
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [17  7  4  9  2]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 4, 7, 9, 17]
------------------------- time cost ------------------------- 1005.4881076812744

------------- Round 17-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0788
Averaged Test Accurancy: 0.3528
Averaged Test AUC: 0.7045
Std Test Accurancy: 0.1097
Std Test AUC: 0.0872
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 7  1  3 10 18]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 3, 7, 10, 18]
------------------------- time cost ------------------------- 1024.9735565185547

------------- Round 18-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8771
Averaged Test Accurancy: 0.3685
Averaged Test AUC: 0.7064
Std Test Accurancy: 0.1001
Std Test AUC: 0.0740
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 7 19  8 17 13]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [7, 8, 13, 17, 19]
------------------------- time cost ------------------------- 1151.7331717014313

------------- Round 19-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.1224
Averaged Test Accurancy: 0.3635
Averaged Test AUC: 0.7187
Std Test Accurancy: 0.1096
Std Test AUC: 0.0869
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 9  3  8 14 19]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 8, 9, 14, 19]
------------------------- time cost ------------------------- 1192.0361187458038

------------- Round 20-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9360
Averaged Test Accurancy: 0.3508
Averaged Test AUC: 0.7061
Std Test Accurancy: 0.1058
Std Test AUC: 0.0801
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 4  6  3 17  7]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 4, 6, 7, 17]
------------------------- time cost ------------------------- 1264.9876732826233

------------- Round 21-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.1041
Averaged Test Accurancy: 0.3477
Averaged Test AUC: 0.7219
Std Test Accurancy: 0.1048
Std Test AUC: 0.0848
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 6 11  8 16  7]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 7, 8, 11, 16]
------------------------- time cost ------------------------- 1188.4797868728638

------------- Round 22-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8517
Averaged Test Accurancy: 0.3609
Averaged Test AUC: 0.7129
Std Test Accurancy: 0.1036
Std Test AUC: 0.0783
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 1 19  7  6  0]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 1, 6, 7, 19]
------------------------- time cost ------------------------- 1344.4272391796112

------------- Round 23-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9020
Averaged Test Accurancy: 0.3518
Averaged Test AUC: 0.6922
Std Test Accurancy: 0.1017
Std Test AUC: 0.0833
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 4 18 14 15  7]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 7, 14, 15, 18]
------------------------- time cost ------------------------- 1389.6233608722687

------------- Round 24-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8147
Averaged Test Accurancy: 0.3325
Averaged Test AUC: 0.7285
Std Test Accurancy: 0.1124
Std Test AUC: 0.0973
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 4  8 18 16  5]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 5, 8, 16, 18]
------------------------- time cost ------------------------- 1545.0834975242615

------------- Round 25-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.7923
Averaged Test Accurancy: 0.3518
Averaged Test AUC: 0.7281
Std Test Accurancy: 0.1063
Std Test AUC: 0.0785
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [11 18  6 14 12]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 11, 12, 14, 18]
------------------------- time cost ------------------------- 1603.7509157657623

------------- Round 26-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.7937
Averaged Test Accurancy: 0.3421
Averaged Test AUC: 0.7143
Std Test Accurancy: 0.1117
Std Test AUC: 0.0912
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [14  3  5  0  1]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 1, 3, 5, 14]
------------------------- time cost ------------------------- 1549.8930325508118

------------- Round 27-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9718
Averaged Test Accurancy: 0.3452
Averaged Test AUC: 0.6961
Std Test Accurancy: 0.1056
Std Test AUC: 0.0749
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 4  2 10 17 14]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 4, 10, 14, 17]
------------------------- time cost ------------------------- 1700.7473449707031

------------- Round 28-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.7697
Averaged Test Accurancy: 0.2883
Averaged Test AUC: 0.7073
Std Test Accurancy: 0.1291
Std Test AUC: 0.0772
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [16 14  9 10  2]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 9, 10, 14, 16]
------------------------- time cost ------------------------- 1652.1550438404083

------------- Round 29-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0180
Averaged Test Accurancy: 0.3320
Averaged Test AUC: 0.6401
Std Test Accurancy: 0.1020
Std Test AUC: 0.0692
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 0 10 18 15 14]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 10, 14, 15, 18]
------------------------- time cost ------------------------- 1856.5225970745087

------------- Round 30-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.7377
Averaged Test Accurancy: 0.3452
Averaged Test AUC: 0.7026
Std Test Accurancy: 0.0952
Std Test AUC: 0.0700
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [15 10  2 19 13]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 10, 13, 15, 19]
------------------------- time cost ------------------------- 1847.14218211174

------------- Round 31-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9120
Averaged Test Accurancy: 0.3345
Averaged Test AUC: 0.7068
Std Test Accurancy: 0.1050
Std Test AUC: 0.0764
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [16  6 13  2  1]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 2, 6, 13, 16]
------------------------- time cost ------------------------- 1877.6298613548279

------------- Round 32-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8882
Averaged Test Accurancy: 0.2030
Averaged Test AUC: 0.6635
Std Test Accurancy: 0.0788
Std Test AUC: 0.0767
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 0  8  6 17 16]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 6, 8, 16, 17]
------------------------- time cost ------------------------- 1828.2954897880554

------------- Round 33-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9987
Averaged Test Accurancy: 0.3299
Averaged Test AUC: 0.6564
Std Test Accurancy: 0.1008
Std Test AUC: 0.0909
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [4 6 2 7 0]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 2, 4, 6, 7]
------------------------- time cost ------------------------- 1943.8260753154755

------------- Round 34-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8916
Averaged Test Accurancy: 0.3508
Averaged Test AUC: 0.7278
Std Test Accurancy: 0.0924
Std Test AUC: 0.0911
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [15  8  4  3 17]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 4, 8, 15, 17]
------------------------- time cost ------------------------- 1987.0087957382202

------------- Round 35-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8534
Averaged Test Accurancy: 0.3492
Averaged Test AUC: 0.7072
Std Test Accurancy: 0.1086
Std Test AUC: 0.0824
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 7 16  8 15 11]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [7, 8, 11, 15, 16]
------------------------- time cost ------------------------- 2054.663021326065

------------- Round 36-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0222
Averaged Test Accurancy: 0.3355
Averaged Test AUC: 0.7023
Std Test Accurancy: 0.1073
Std Test AUC: 0.0753
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [10  8 19 15 16]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [8, 10, 15, 16, 19]
------------------------- time cost ------------------------- 2185.839175224304

------------- Round 37-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0315
Averaged Test Accurancy: 0.3406
Averaged Test AUC: 0.6973
Std Test Accurancy: 0.1047
Std Test AUC: 0.0668
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 4  9 17 14  5]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 5, 9, 14, 17]
------------------------- time cost ------------------------- 2138.201027870178

------------- Round 38-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.7702
Averaged Test Accurancy: 0.3431
Averaged Test AUC: 0.7096
Std Test Accurancy: 0.1211
Std Test AUC: 0.0817
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [16 18  6  2  9]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 6, 9, 16, 18]
------------------------- time cost ------------------------- 2163.1101167201996

------------- Round 39-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9707
Averaged Test Accurancy: 0.3574
Averaged Test AUC: 0.7141
Std Test Accurancy: 0.1225
Std Test AUC: 0.0772
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 9 18 15  8  1]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 8, 9, 15, 18]
------------------------- time cost ------------------------- 2079.2960805892944

------------- Round 40-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8191
Averaged Test Accurancy: 0.2853
Averaged Test AUC: 0.6686
Std Test Accurancy: 0.1143
Std Test AUC: 0.0958
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [16 14  4  2  6]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 4, 6, 14, 16]
------------------------- time cost ------------------------- 2222.2432746887207

------------- Round 41-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0232
Averaged Test Accurancy: 0.3396
Averaged Test AUC: 0.6825
Std Test Accurancy: 0.1090
Std Test AUC: 0.0751
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 7 15  2 11 18]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 7, 11, 15, 18]
------------------------- time cost ------------------------- 2193.277177810669

------------- Round 42-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8626
Averaged Test Accurancy: 0.3411
Averaged Test AUC: 0.6694
Std Test Accurancy: 0.1008
Std Test AUC: 0.0789
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [17 14 13  4  7]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 7, 13, 14, 17]
------------------------- time cost ------------------------- 2069.8151664733887

------------- Round 43-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0437
Averaged Test Accurancy: 0.2980
Averaged Test AUC: 0.6759
Std Test Accurancy: 0.1125
Std Test AUC: 0.0716
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 7 17  3 10 15]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 7, 10, 15, 17]
------------------------- time cost ------------------------- 2078.6968507766724

------------- Round 44-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9366
Averaged Test Accurancy: 0.3188
Averaged Test AUC: 0.6980
Std Test Accurancy: 0.1113
Std Test AUC: 0.0827
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [14 19 15 17  1]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 14, 15, 17, 19]
------------------------- time cost ------------------------- 2064.1415033340454

------------- Round 45-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8829
Averaged Test Accurancy: 0.3584
Averaged Test AUC: 0.7103
Std Test Accurancy: 0.0970
Std Test AUC: 0.0775
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [18  2  9 15  8]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 8, 9, 15, 18]
------------------------- time cost ------------------------- 2244.0451879501343

------------- Round 46-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.1363
Averaged Test Accurancy: 0.3249
Averaged Test AUC: 0.6983
Std Test Accurancy: 0.1339
Std Test AUC: 0.0838
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [18 14  9  4  3]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 4, 9, 14, 18]
------------------------- time cost ------------------------- 2390.42414021492

------------- Round 47-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8999
Averaged Test Accurancy: 0.3447
Averaged Test AUC: 0.7402
Std Test Accurancy: 0.0957
Std Test AUC: 0.0799
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 4  7 16  6  0]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 4, 6, 7, 16]
------------------------- time cost ------------------------- 2330.9715325832367

------------- Round 48-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.1389
Averaged Test Accurancy: 0.3411
Averaged Test AUC: 0.7022
Std Test Accurancy: 0.0940
Std Test AUC: 0.0889
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 4 14 11 16 17]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 11, 14, 16, 17]
------------------------- time cost ------------------------- 2381.231668949127

------------- Round 49-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.1184
Averaged Test Accurancy: 0.3492
Averaged Test AUC: 0.7013
Std Test Accurancy: 0.0981
Std Test AUC: 0.0849
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [16 19  7  3 12]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 7, 12, 16, 19]
------------------------- time cost ------------------------- 2366.4324066638947

------------- Round 50-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.1080
Averaged Test Accurancy: 0.3310
Averaged Test AUC: 0.7066
Std Test Accurancy: 0.0894
Std Test AUC: 0.0831
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [11 17 15  5  0]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 5, 11, 15, 17]
------------------------- time cost ------------------------- 2395.117991924286

------------- Round 51-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9402
Averaged Test Accurancy: 0.3579
Averaged Test AUC: 0.6923
Std Test Accurancy: 0.1065
Std Test AUC: 0.0924
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 6  8 13  1 18]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 6, 8, 13, 18]
------------------------- time cost ------------------------- 2401.343905687332

------------- Round 52-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9428
Averaged Test Accurancy: 0.3376
Averaged Test AUC: 0.7080
Std Test Accurancy: 0.1102
Std Test AUC: 0.0887
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [19 15 14 16  6]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 14, 15, 16, 19]
------------------------- time cost ------------------------- 2424.9456102848053

------------- Round 53-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0005
Averaged Test Accurancy: 0.3269
Averaged Test AUC: 0.6465
Std Test Accurancy: 0.1131
Std Test AUC: 0.0836
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [13 16  2  9  5]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 5, 9, 13, 16]
------------------------- time cost ------------------------- 2188.487764120102

------------- Round 54-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8421
Averaged Test Accurancy: 0.3416
Averaged Test AUC: 0.6998
Std Test Accurancy: 0.0982
Std Test AUC: 0.0824
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 2 13 11  5 18]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 5, 11, 13, 18]
------------------------- time cost ------------------------- 1969.180758714676

------------- Round 55-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.1455
Averaged Test Accurancy: 0.3477
Averaged Test AUC: 0.7279
Std Test Accurancy: 0.0940
Std Test AUC: 0.0687
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [18  6  3 15 17]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 6, 15, 17, 18]
------------------------- time cost ------------------------- 1855.5110034942627

------------- Round 56-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.1087
Averaged Test Accurancy: 0.3254
Averaged Test AUC: 0.7019
Std Test Accurancy: 0.1023
Std Test AUC: 0.0817
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [19 14 16 12  1]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 12, 14, 16, 19]
------------------------- time cost ------------------------- 1854.4807152748108

------------- Round 57-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0018
Averaged Test Accurancy: 0.3122
Averaged Test AUC: 0.6949
Std Test Accurancy: 0.1133
Std Test AUC: 0.0839
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [19 16  3  9  7]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 7, 9, 16, 19]
------------------------- time cost ------------------------- 1852.8700184822083

------------- Round 58-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9337
Averaged Test Accurancy: 0.2883
Averaged Test AUC: 0.6861
Std Test Accurancy: 0.1102
Std Test AUC: 0.0740
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 3  7 19  0  4]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 3, 4, 7, 19]
------------------------- time cost ------------------------- 1832.1852705478668

------------- Round 59-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8909
Averaged Test Accurancy: 0.3371
Averaged Test AUC: 0.6753
Std Test Accurancy: 0.1163
Std Test AUC: 0.0928
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [17  9  2  3  7]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 3, 7, 9, 17]
------------------------- time cost ------------------------- 1914.004369020462

------------- Round 60-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0997
Averaged Test Accurancy: 0.3543
Averaged Test AUC: 0.7316
Std Test Accurancy: 0.0988
Std Test AUC: 0.0640
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [16  9 12  1 13]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 9, 12, 13, 16]
------------------------- time cost ------------------------- 1976.3901240825653

------------- Round 61-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8879
Averaged Test Accurancy: 0.3447
Averaged Test AUC: 0.7186
Std Test Accurancy: 0.0928
Std Test AUC: 0.0841
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 6 16  7  9 18]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 7, 9, 16, 18]
------------------------- time cost ------------------------- 2017.7491323947906

------------- Round 62-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9375
Averaged Test Accurancy: 0.3168
Averaged Test AUC: 0.7062
Std Test Accurancy: 0.1076
Std Test AUC: 0.0725
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [18 19 11 14  2]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 11, 14, 18, 19]
------------------------- time cost ------------------------- 2075.86953830719

------------- Round 63-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0837
Averaged Test Accurancy: 0.3162
Averaged Test AUC: 0.7068
Std Test Accurancy: 0.1012
Std Test AUC: 0.0854
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [11  4  9 16  3]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 4, 9, 11, 16]
------------------------- time cost ------------------------- 2066.0388028621674

------------- Round 64-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9898
Averaged Test Accurancy: 0.3142
Averaged Test AUC: 0.6979
Std Test Accurancy: 0.0943
Std Test AUC: 0.0869
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [15  7  0 12 10]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 7, 10, 12, 15]
------------------------- time cost ------------------------- 2099.5675625801086

------------- Round 65-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9689
Averaged Test Accurancy: 0.3259
Averaged Test AUC: 0.6646
Std Test Accurancy: 0.0916
Std Test AUC: 0.0886
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [17  1  2 15 19]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 2, 15, 17, 19]
------------------------- time cost ------------------------- 2193.3701333999634

------------- Round 66-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0767
Averaged Test Accurancy: 0.3330
Averaged Test AUC: 0.6972
Std Test Accurancy: 0.0957
Std Test AUC: 0.0893
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [6 0 5 7 9]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 5, 6, 7, 9]
------------------------- time cost ------------------------- 2183.5722484588623

------------- Round 67-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8760
Averaged Test Accurancy: 0.3355
Averaged Test AUC: 0.7242
Std Test Accurancy: 0.0935
Std Test AUC: 0.0876
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 8  6  9 14 16]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 8, 9, 14, 16]
------------------------- time cost ------------------------- 2150.3351538181305

------------- Round 68-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0267
Averaged Test Accurancy: 0.3239
Averaged Test AUC: 0.6783
Std Test Accurancy: 0.0995
Std Test AUC: 0.0716
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [11 13  5  2  9]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 5, 9, 11, 13]
------------------------- time cost ------------------------- 2130.9200496673584

------------- Round 69-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.2001
Averaged Test Accurancy: 0.3421
Averaged Test AUC: 0.6727
Std Test Accurancy: 0.0877
Std Test AUC: 0.0753
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [12 13 16 15  2]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 12, 13, 15, 16]
------------------------- time cost ------------------------- 2162.937844276428

------------- Round 70-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.2841
Averaged Test Accurancy: 0.3376
Averaged Test AUC: 0.6737
Std Test Accurancy: 0.0953
Std Test AUC: 0.0833
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [14 13  6  8 18]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 8, 13, 14, 18]
------------------------- time cost ------------------------- 2120.7396235466003

------------- Round 71-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0067
Averaged Test Accurancy: 0.3234
Averaged Test AUC: 0.6642
Std Test Accurancy: 0.1033
Std Test AUC: 0.0713
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 6 12 16 13  2]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 6, 12, 13, 16]
------------------------- time cost ------------------------- 2200.894438266754

------------- Round 72-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0559
Averaged Test Accurancy: 0.3254
Averaged Test AUC: 0.6835
Std Test Accurancy: 0.0963
Std Test AUC: 0.0876
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [13 14  9 19  4]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 9, 13, 14, 19]
------------------------- time cost ------------------------- 2191.0152723789215

------------- Round 73-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9581
Averaged Test Accurancy: 0.2904
Averaged Test AUC: 0.6725
Std Test Accurancy: 0.1143
Std Test AUC: 0.0753
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 0  7 18  6 16]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 6, 7, 16, 18]
------------------------- time cost ------------------------- 2186.7182466983795

------------- Round 74-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.1711
Averaged Test Accurancy: 0.2766
Averaged Test AUC: 0.6810
Std Test Accurancy: 0.1288
Std Test AUC: 0.0730
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 0  7 15  9  8]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 7, 8, 9, 15]
------------------------- time cost ------------------------- 2208.5693950653076

------------- Round 75-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0590
Averaged Test Accurancy: 0.3406
Averaged Test AUC: 0.7204
Std Test Accurancy: 0.1009
Std Test AUC: 0.0632
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 9 16  6 13  2]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 6, 9, 13, 16]
------------------------- time cost ------------------------- 2196.7248690128326

------------- Round 76-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0096
Averaged Test Accurancy: 0.2990
Averaged Test AUC: 0.6780
Std Test Accurancy: 0.1065
Std Test AUC: 0.0714
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [18  9 14  7  1]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 7, 9, 14, 18]
------------------------- time cost ------------------------- 2194.296189546585

------------- Round 77-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0137
Averaged Test Accurancy: 0.3228
Averaged Test AUC: 0.6658
Std Test Accurancy: 0.1108
Std Test AUC: 0.0673
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [10  9 19  6 16]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 9, 10, 16, 19]
------------------------- time cost ------------------------- 2201.88512635231

------------- Round 78-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0179
Averaged Test Accurancy: 0.3340
Averaged Test AUC: 0.7257
Std Test Accurancy: 0.1006
Std Test AUC: 0.0756
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [17 13 14 16 19]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [13, 14, 16, 17, 19]
------------------------- time cost ------------------------- 2238.525243997574

------------- Round 79-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9406
Averaged Test Accurancy: 0.3462
Averaged Test AUC: 0.7073
Std Test Accurancy: 0.0899
Std Test AUC: 0.0656
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [11  8 17  9  1]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 8, 9, 11, 17]
------------------------- time cost ------------------------- 2179.5179784297943

------------- Round 80-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9346
Averaged Test Accurancy: 0.3299
Averaged Test AUC: 0.6582
Std Test Accurancy: 0.1035
Std Test AUC: 0.0665
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 8 13  6  0  3]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 3, 6, 8, 13]
------------------------- time cost ------------------------- 2231.811719417572

------------- Round 81-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0586
Averaged Test Accurancy: 0.3269
Averaged Test AUC: 0.6759
Std Test Accurancy: 0.1124
Std Test AUC: 0.0787
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [14 18  8  3 19]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 8, 14, 18, 19]
------------------------- time cost ------------------------- 2188.5616545677185

------------- Round 82-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9295
Averaged Test Accurancy: 0.3492
Averaged Test AUC: 0.6843
Std Test Accurancy: 0.1122
Std Test AUC: 0.0682
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [11  2 17 14 18]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 11, 14, 17, 18]
------------------------- time cost ------------------------- 2178.214127779007

------------- Round 83-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.1563
Averaged Test Accurancy: 0.3112
Averaged Test AUC: 0.6701
Std Test Accurancy: 0.1112
Std Test AUC: 0.0725
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [18 14 15  6  4]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 6, 14, 15, 18]
------------------------- time cost ------------------------- 2219.6464397907257

------------- Round 84-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9413
Averaged Test Accurancy: 0.3051
Averaged Test AUC: 0.7154
Std Test Accurancy: 0.1169
Std Test AUC: 0.0750
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [14 10 17 18 13]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [10, 13, 14, 17, 18]
------------------------- time cost ------------------------- 2276.3623373508453

------------- Round 85-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.2241
Averaged Test Accurancy: 0.3152
Averaged Test AUC: 0.6937
Std Test Accurancy: 0.0860
Std Test AUC: 0.0869
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [10  6 14 15 16]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 10, 14, 15, 16]
------------------------- time cost ------------------------- 2206.2046403884888

------------- Round 86-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.7227
Averaged Test Accurancy: 0.3157
Averaged Test AUC: 0.7121
Std Test Accurancy: 0.1036
Std Test AUC: 0.0815
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 3  7 19 16  9]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 7, 9, 16, 19]
------------------------- time cost ------------------------- 2226.5677852630615

------------- Round 87-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0992
Averaged Test Accurancy: 0.3157
Averaged Test AUC: 0.6667
Std Test Accurancy: 0.1020
Std Test AUC: 0.0852
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 9  2 14  5  0]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 2, 5, 9, 14]
------------------------- time cost ------------------------- 2250.9088151454926

------------- Round 88-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8475
Averaged Test Accurancy: 0.3178
Averaged Test AUC: 0.6838
Std Test Accurancy: 0.1057
Std Test AUC: 0.0770
--- Training 20 clients ---
> Post-training selection: choosing 5 from 20 trained clients.
>   (Using local losses as metric for AFL)
5 selected users: [ 4 11  6 17 18]
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 6, 11, 17, 18]
------------------------- time cost ------------------------- 2359.2164516448975

------------- Round 89-------------
> Post-training selection enabled for method 'AFL'.
> Sending global model to 20 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8264
Averaged Test Accurancy: 0.3396
Averaged Test AUC: 0.7178
Std Test Accurancy: 0.1065
Std Test AUC: 0.0828
--- Training 20 clients ---
Traceback (most recent call last):
  File "C:\Program Files\Python37\lib\runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "C:\Program Files\Python37\lib\runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "C:\Users\owner\Downloads\Benchmark_Stage_backup2\Benchmark_Stage\system_shot_imbalance\main.py", line 235, in <module>
    run(args, client_selection)
  File "C:\Users\owner\Downloads\Benchmark_Stage_backup2\Benchmark_Stage\system_shot_imbalance\main.py", line 145, in run
    server.train()
  File "C:\Users\owner\Downloads\Benchmark_Stage_backup2\Benchmark_Stage\system_shot_imbalance\flcore\servers\serveravg.py", line 151, in train
    local_losses, accuracy, local_metrics = self.train_clients(clients_for_training)
  File "C:\Users\owner\Downloads\Benchmark_Stage_backup2\Benchmark_Stage\system_shot_imbalance\flcore\servers\serverbase.py", line 486, in train_clients
    train_result = client.train()
  File "C:\Users\owner\Downloads\Benchmark_Stage_backup2\Benchmark_Stage\system_shot_imbalance\flcore\clients\clientavg.py", line 38, in train
    result=self.model.update(trainloader)
  File "C:\Users\owner\Downloads\Benchmark_Stage_backup2\Benchmark_Stage\system_shot_imbalance\flcore\algorithms\algorithms.py", line 132, in update
    loss.backward()
  File "C:\Users\owner\AppData\Roaming\Python\Python37\site-packages\torch\tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "C:\Users\owner\AppData\Roaming\Python\Python37\site-packages\torch\autograd\__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
