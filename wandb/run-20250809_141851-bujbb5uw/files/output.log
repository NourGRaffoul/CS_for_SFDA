
cuda is not avaiable.

==================================================
goal = test
device = cpu
device_id = 0
dataset = HAR
num_classes = 6
model = CNN
batch_size = 10
local_learning_rate = 0.01
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 60
top_cnt = 100
local_epochs = 10
algorithm = FedAvg
join_ratio = 0.25
random_join_ratio = False
num_clients = 20
prev = 0
times = 1
eval_gap = 1
save_folder_name = items
auto_break = False
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 80
max_len = 200
few_shot = 0
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.0
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 1.0
plocal_epochs = 1
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 0.1
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.1
kl_weight = 0.0
num_candidates = 10
method = Cluster1
comment =
num_clients_per_round = 5
num_available = None
loss_div_sqrt = False
loss_sum = False
subset_ratio = 0.1
alpha1 = 0.75
alpha2 = 1
alpha3 = 0.1
save_probs = False
no_save_results = False
src_id = 1
imbalance_factor = 50.0
total_num_clients = 20
num_epoch = 10
wandb = True
==================================================

****** Client source: 1 *******
Accuracy of source client: 97.80%

============= Running time: 0th =============
Creating server and clients ...
CNN
Initializing client selection method: Cluster1
Pre-loading and preparing all client data...
INFO: Simulating imbalance with factor 50.0 for client 0 training data.
INFO: Simulating imbalance with factor 50.0 for client 1 training data.
INFO: Simulating imbalance with factor 50.0 for client 2 training data.
INFO: Simulating imbalance with factor 50.0 for client 3 training data.
INFO: Simulating imbalance with factor 50.0 for client 4 training data.
INFO: Simulating imbalance with factor 50.0 for client 5 training data.
INFO: Simulating imbalance with factor 50.0 for client 6 training data.
INFO: Simulating imbalance with factor 50.0 for client 7 training data.
INFO: Simulating imbalance with factor 50.0 for client 8 training data.
INFO: Simulating imbalance with factor 50.0 for client 9 training data.
INFO: Simulating imbalance with factor 50.0 for client 10 training data.
INFO: Simulating imbalance with factor 50.0 for client 11 training data.
INFO: Simulating imbalance with factor 50.0 for client 12 training data.
INFO: Simulating imbalance with factor 50.0 for client 13 training data.
INFO: Simulating imbalance with factor 50.0 for client 14 training data.
INFO: Simulating imbalance with factor 50.0 for client 15 training data.
INFO: Simulating imbalance with factor 50.0 for client 16 training data.
INFO: Simulating imbalance with factor 50.0 for client 17 training data.
INFO: Simulating imbalance with factor 50.0 for client 18 training data.
INFO: Simulating imbalance with factor 50.0 for client 19 training data.
Data loading complete.

Join ratio / total clients: 0.25 / 20
Finished creating server and clients.

------------- Round 0-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [18  0  5  4  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 0.8139
Averaged Test Accurancy: 0.7609
Averaged Test AUC: 0.8797
Std Test Accurancy: 0.1663
Std Test AUC: 0.0932
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 4, 5, 9, 18]
------------------------- time cost ------------------------- 115.34203910827637

------------- Round 1-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [18  2 12  6  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.6863
Averaged Test Accurancy: 0.3751
Averaged Test AUC: 0.7138
Std Test Accurancy: 0.1169
Std Test AUC: 0.0561
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 6, 9, 12, 18]
------------------------- time cost ------------------------- 104.6048059463501

------------- Round 2-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17  0 14 11  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 1.9067
Averaged Test Accurancy: 0.3345
Averaged Test AUC: 0.6895
Std Test Accurancy: 0.1074
Std Test AUC: 0.0758
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 7, 11, 14, 17]
------------------------- time cost ------------------------- 108.41981077194214

------------- Round 3-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16 14 14  6  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.6795
Averaged Test Accurancy: 0.3812
Averaged Test AUC: 0.6542
Std Test Accurancy: 0.1058
Std Test AUC: 0.0647
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 6, 14, 14, 16]
------------------------- time cost ------------------------- 106.95278239250183

------------- Round 4-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17  0 12 10  4]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.3028
Averaged Test Accurancy: 0.3254
Averaged Test AUC: 0.6801
Std Test Accurancy: 0.0834
Std Test AUC: 0.0603
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 4, 10, 12, 17]
------------------------- time cost ------------------------- 110.15629625320435

------------- Round 5-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16  2 14  3  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.5444
Averaged Test Accurancy: 0.3685
Averaged Test AUC: 0.6454
Std Test Accurancy: 0.0919
Std Test AUC: 0.0639
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 3, 9, 14, 16]
------------------------- time cost ------------------------- 107.55503964424133

------------- Round 6-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [18 18  5  4  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.4788
Averaged Test Accurancy: 0.4051
Averaged Test AUC: 0.6697
Std Test Accurancy: 0.0936
Std Test AUC: 0.0527
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 5, 9, 18, 18]
------------------------- time cost ------------------------- 102.85007071495056

------------- Round 7-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15  0  5 10  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.0516
Averaged Test Accurancy: 0.4360
Averaged Test AUC: 0.7120
Std Test Accurancy: 0.0811
Std Test AUC: 0.0538
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 1, 5, 10, 15]
------------------------- time cost ------------------------- 117.46880459785461

------------- Round 8-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16 19 13 11  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.4801
Averaged Test Accurancy: 0.3812
Averaged Test AUC: 0.6980
Std Test Accurancy: 0.0744
Std Test AUC: 0.0502
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [9, 11, 13, 16, 19]
------------------------- time cost ------------------------- 99.7185115814209

------------- Round 9-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15  0  5 10  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.1959
Averaged Test Accurancy: 0.4117
Averaged Test AUC: 0.7476
Std Test Accurancy: 0.0694
Std Test AUC: 0.0466
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 5, 9, 10, 15]
------------------------- time cost ------------------------- 114.56947875022888

------------- Round 10-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17  2  5 10  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.1906
Averaged Test Accurancy: 0.4127
Averaged Test AUC: 0.6971
Std Test Accurancy: 0.0716
Std Test AUC: 0.0673
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 5, 7, 10, 17]
------------------------- time cost ------------------------- 100.62318253517151

------------- Round 11-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16 18 13 10  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8835
Averaged Test Accurancy: 0.3457
Averaged Test AUC: 0.6616
Std Test Accurancy: 0.0864
Std Test AUC: 0.0446
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 10, 13, 16, 18]
------------------------- time cost ------------------------- 110.2039635181427

------------- Round 12-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17  2 12 11  4]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.4454
Averaged Test Accurancy: 0.3761
Averaged Test AUC: 0.7097
Std Test Accurancy: 0.0692
Std Test AUC: 0.0510
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 4, 11, 12, 17]
------------------------- time cost ------------------------- 97.79966950416565

------------- Round 13-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17 19 13 10  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.4942
Averaged Test Accurancy: 0.4081
Averaged Test AUC: 0.7366
Std Test Accurancy: 0.0834
Std Test AUC: 0.0518
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [9, 10, 13, 17, 19]
------------------------- time cost ------------------------- 102.63993501663208

------------- Round 14-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [18 19 12 10  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.5854
Averaged Test Accurancy: 0.3990
Averaged Test AUC: 0.7122
Std Test Accurancy: 0.0599
Std Test AUC: 0.0451
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 10, 12, 18, 19]
------------------------- time cost ------------------------- 105.83897662162781

------------- Round 15-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17  2 12  6  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.3980
Averaged Test Accurancy: 0.3761
Averaged Test AUC: 0.7305
Std Test Accurancy: 0.0818
Std Test AUC: 0.0643
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 6, 7, 12, 17]
------------------------- time cost ------------------------- 102.1011688709259

------------- Round 16-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17  0  5 10  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.6505
Averaged Test Accurancy: 0.3508
Averaged Test AUC: 0.6739
Std Test Accurancy: 0.0988
Std Test AUC: 0.0596
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 5, 8, 10, 17]
------------------------- time cost ------------------------- 110.16829562187195

------------- Round 17-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15  0 13  3  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 5.0880
Averaged Test Accurancy: 0.3020
Averaged Test AUC: 0.6344
Std Test Accurancy: 0.1078
Std Test AUC: 0.0647
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 3, 7, 13, 15]
------------------------- time cost ------------------------- 109.95412874221802

------------- Round 18-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17  0  5  3  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.9090
Averaged Test Accurancy: 0.3609
Averaged Test AUC: 0.6440
Std Test Accurancy: 0.1010
Std Test AUC: 0.0705
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 3, 5, 7, 17]
------------------------- time cost ------------------------- 111.31463432312012

------------- Round 19-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16  0  5 10  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.5309
Averaged Test Accurancy: 0.3751
Averaged Test AUC: 0.7088
Std Test Accurancy: 0.0892
Std Test AUC: 0.0679
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 5, 9, 10, 16]
------------------------- time cost ------------------------- 115.18441557884216

------------- Round 20-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16 14 13  6  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0165
Averaged Test Accurancy: 0.3873
Averaged Test AUC: 0.7221
Std Test Accurancy: 0.0839
Std Test AUC: 0.0705
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 6, 13, 14, 16]
------------------------- time cost ------------------------- 105.66051530838013

------------- Round 21-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17 19 14 10  4]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.6492
Averaged Test Accurancy: 0.3685
Averaged Test AUC: 0.7032
Std Test Accurancy: 0.0986
Std Test AUC: 0.0816
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 10, 14, 17, 19]
------------------------- time cost ------------------------- 100.39362001419067

------------- Round 22-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15  2 13 10  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.5071
Averaged Test Accurancy: 0.3569
Averaged Test AUC: 0.6946
Std Test Accurancy: 0.0603
Std Test AUC: 0.0554
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 7, 10, 13, 15]
------------------------- time cost ------------------------- 97.99759125709534

------------- Round 23-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [18 18  5  6  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.4210
Averaged Test Accurancy: 0.3746
Averaged Test AUC: 0.6818
Std Test Accurancy: 0.0894
Std Test AUC: 0.0630
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 6, 7, 18, 18]
------------------------- time cost ------------------------- 100.92263889312744

------------- Round 24-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16 19 14  6  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.5083
Averaged Test Accurancy: 0.3761
Averaged Test AUC: 0.6803
Std Test Accurancy: 0.0847
Std Test AUC: 0.0654
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 9, 14, 16, 19]
------------------------- time cost ------------------------- 97.16441202163696

------------- Round 25-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [18 19 13 10  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 5.1548
Averaged Test Accurancy: 0.3477
Averaged Test AUC: 0.6607
Std Test Accurancy: 0.0849
Std Test AUC: 0.0502
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [8, 10, 13, 18, 19]
------------------------- time cost ------------------------- 97.64043307304382

------------- Round 26-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17 18  5  3  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 5.5672
Averaged Test Accurancy: 0.3335
Averaged Test AUC: 0.6442
Std Test Accurancy: 0.1067
Std Test AUC: 0.0658
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 5, 8, 17, 18]
------------------------- time cost ------------------------- 97.4483711719513

------------- Round 27-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15 18 13  4  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 5.5291
Averaged Test Accurancy: 0.3406
Averaged Test AUC: 0.6323
Std Test Accurancy: 0.0937
Std Test AUC: 0.0664
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 8, 13, 15, 18]
------------------------- time cost ------------------------- 96.30033850669861

------------- Round 28-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15  2 11  6  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 4.9435
Averaged Test Accurancy: 0.3411
Averaged Test AUC: 0.6524
Std Test Accurancy: 0.0878
Std Test AUC: 0.0671
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 6, 8, 11, 15]
------------------------- time cost ------------------------- 92.64710402488708

------------- Round 29-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17  0  5  3  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 4.4851
Averaged Test Accurancy: 0.3350
Averaged Test AUC: 0.6677
Std Test Accurancy: 0.0836
Std Test AUC: 0.0633
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 3, 5, 8, 17]
------------------------- time cost ------------------------- 111.23330235481262

------------- Round 30-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17 19 12 11  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 4.4973
Averaged Test Accurancy: 0.3472
Averaged Test AUC: 0.6456
Std Test Accurancy: 0.0855
Std Test AUC: 0.0735
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [8, 11, 12, 17, 19]
------------------------- time cost ------------------------- 92.26004123687744

------------- Round 31-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16 19 12  3  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 4.1934
Averaged Test Accurancy: 0.3487
Averaged Test AUC: 0.6806
Std Test Accurancy: 0.0870
Std Test AUC: 0.0737
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 9, 12, 16, 19]
------------------------- time cost ------------------------- 101.61041808128357

------------- Round 32-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17  0 12  3  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 8.0964
Averaged Test Accurancy: 0.3741
Averaged Test AUC: 0.6801
Std Test Accurancy: 0.0816
Std Test AUC: 0.0568
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 3, 8, 12, 17]
------------------------- time cost ------------------------- 105.76349902153015

------------- Round 33-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15  0 14  3  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 4.6616
Averaged Test Accurancy: 0.3244
Averaged Test AUC: 0.6505
Std Test Accurancy: 0.0813
Std Test AUC: 0.0631
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 3, 7, 14, 15]
------------------------- time cost ------------------------- 106.07776927947998

------------- Round 34-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17  0 13 10  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.4568
Averaged Test Accurancy: 0.3812
Averaged Test AUC: 0.7106
Std Test Accurancy: 0.0877
Std Test AUC: 0.0805
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 7, 10, 13, 17]
------------------------- time cost ------------------------- 105.29314255714417

------------- Round 35-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16 19 14  4  4]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.6219
Averaged Test Accurancy: 0.3726
Averaged Test AUC: 0.6913
Std Test Accurancy: 0.0983
Std Test AUC: 0.0798
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 4, 14, 16, 19]
------------------------- time cost ------------------------- 94.43901920318604

------------- Round 36-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17 19 12 11  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 13.3731
Averaged Test Accurancy: 0.3360
Averaged Test AUC: 0.6529
Std Test Accurancy: 0.0623
Std Test AUC: 0.0774
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [9, 11, 12, 17, 19]
------------------------- time cost ------------------------- 92.00129008293152

------------- Round 37-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [18 19  5  4  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 6.2673
Averaged Test Accurancy: 0.3569
Averaged Test AUC: 0.6510
Std Test Accurancy: 0.0799
Std Test AUC: 0.0481
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 5, 8, 18, 19]
------------------------- time cost ------------------------- 94.87760877609253

------------- Round 38-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [18  0 11 11  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 4.0958
Averaged Test Accurancy: 0.3173
Averaged Test AUC: 0.6338
Std Test Accurancy: 0.1057
Std Test AUC: 0.0818
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 8, 11, 11, 18]
------------------------- time cost ------------------------- 103.51533508300781

------------- Round 39-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15  2 12  3  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.8599
Averaged Test Accurancy: 0.3310
Averaged Test AUC: 0.6582
Std Test Accurancy: 0.0960
Std Test AUC: 0.0703
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 3, 7, 12, 15]
------------------------- time cost ------------------------- 95.65312266349792

------------- Round 40-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16 19  5  4  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.7221
Averaged Test Accurancy: 0.3782
Averaged Test AUC: 0.6542
Std Test Accurancy: 0.1176
Std Test AUC: 0.0868
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 5, 9, 16, 19]
------------------------- time cost ------------------------- 96.34455728530884

------------- Round 41-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15 19 12  6  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 6.7766
Averaged Test Accurancy: 0.3513
Averaged Test AUC: 0.6154
Std Test Accurancy: 0.0781
Std Test AUC: 0.0550
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 7, 12, 15, 19]
------------------------- time cost ------------------------- 94.50003743171692

------------- Round 42-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17 19 11 10  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.0206
Averaged Test Accurancy: 0.3695
Averaged Test AUC: 0.6377
Std Test Accurancy: 0.1104
Std Test AUC: 0.0998
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [8, 10, 11, 17, 19]
------------------------- time cost ------------------------- 90.78757834434509

------------- Round 43-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16  2 12  3  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.9604
Averaged Test Accurancy: 0.3452
Averaged Test AUC: 0.6820
Std Test Accurancy: 0.0812
Std Test AUC: 0.0693
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 3, 9, 12, 16]
------------------------- time cost ------------------------- 97.20312285423279

------------- Round 44-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16 19 12  3  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 6.0362
Averaged Test Accurancy: 0.3569
Averaged Test AUC: 0.6599
Std Test Accurancy: 0.0746
Std Test AUC: 0.0500
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 8, 12, 16, 19]
------------------------- time cost ------------------------- 108.05701422691345

------------- Round 45-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15  0 11  6  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.8018
Averaged Test Accurancy: 0.3279
Averaged Test AUC: 0.6624
Std Test Accurancy: 0.0904
Std Test AUC: 0.0711
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 6, 9, 11, 15]
------------------------- time cost ------------------------- 156.85191321372986

------------- Round 46-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17 19 13  6  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 8.2242
Averaged Test Accurancy: 0.3604
Averaged Test AUC: 0.6633
Std Test Accurancy: 0.0728
Std Test AUC: 0.0542
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 8, 13, 17, 19]
------------------------- time cost ------------------------- 136.36307907104492

------------- Round 47-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [18 19  5 10  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 4.6616
Averaged Test Accurancy: 0.3239
Averaged Test AUC: 0.6562
Std Test Accurancy: 0.0843
Std Test AUC: 0.0686
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 8, 10, 18, 19]
------------------------- time cost ------------------------- 100.95956301689148

------------- Round 48-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [18 19 12  6  1]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.8930
Averaged Test Accurancy: 0.3553
Averaged Test AUC: 0.6886
Std Test Accurancy: 0.0824
Std Test AUC: 0.0709
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [1, 6, 12, 18, 19]
------------------------- time cost ------------------------- 102.5950813293457

------------- Round 49-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17  0 12 10  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.3807
Averaged Test Accurancy: 0.3929
Averaged Test AUC: 0.7532
Std Test Accurancy: 0.0892
Std Test AUC: 0.0600
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 7, 10, 12, 17]
------------------------- time cost ------------------------- 148.02651572227478

------------- Round 50-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17 14 11  6  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.8724
Averaged Test Accurancy: 0.3914
Averaged Test AUC: 0.7008
Std Test Accurancy: 0.1040
Std Test AUC: 0.0824
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 8, 11, 14, 17]
------------------------- time cost ------------------------- 171.0372667312622

------------- Round 51-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15 18  5 11  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 4.0991
Averaged Test Accurancy: 0.3497
Averaged Test AUC: 0.6918
Std Test Accurancy: 0.0841
Std Test AUC: 0.0701
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [5, 7, 11, 15, 18]
------------------------- time cost ------------------------- 131.64408254623413

------------- Round 52-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16  0 14  6  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.4727
Averaged Test Accurancy: 0.4066
Averaged Test AUC: 0.6851
Std Test Accurancy: 0.1152
Std Test AUC: 0.0842
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 6, 7, 14, 16]
------------------------- time cost ------------------------- 107.39251899719238

------------- Round 53-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17  2  5  3  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.6837
Averaged Test Accurancy: 0.3949
Averaged Test AUC: 0.7139
Std Test Accurancy: 0.1201
Std Test AUC: 0.0828
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 3, 5, 9, 17]
------------------------- time cost ------------------------- 103.76806569099426

------------- Round 54-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15 19 13  6  7]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 10.7621
Averaged Test Accurancy: 0.3533
Averaged Test AUC: 0.6700
Std Test Accurancy: 0.0778
Std Test AUC: 0.0643
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [6, 7, 13, 15, 19]
------------------------- time cost ------------------------- 122.91233229637146

------------- Round 55-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15 18  5  3  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 2.7698
Averaged Test Accurancy: 0.3949
Averaged Test AUC: 0.6965
Std Test Accurancy: 0.1191
Std Test AUC: 0.0843
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [3, 5, 9, 15, 18]
------------------------- time cost ------------------------- 111.31096601486206

------------- Round 56-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17  0 12  4  4]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 5.2125
Averaged Test Accurancy: 0.3761
Averaged Test AUC: 0.6872
Std Test Accurancy: 0.0808
Std Test AUC: 0.0656
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 4, 4, 12, 17]
------------------------- time cost ------------------------- 181.27314925193787

------------- Round 57-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [17 18 13 10  4]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 4.5564
Averaged Test Accurancy: 0.3371
Averaged Test AUC: 0.6658
Std Test Accurancy: 0.0894
Std Test AUC: 0.0707
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [4, 10, 13, 17, 18]
------------------------- time cost ------------------------- 200.61771321296692

------------- Round 58-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16  0 14  6  4]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 4.0948
Averaged Test Accurancy: 0.3350
Averaged Test AUC: 0.6428
Std Test Accurancy: 0.0969
Std Test AUC: 0.0893
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [0, 4, 6, 14, 16]
------------------------- time cost ------------------------- 184.1720449924469

------------- Round 59-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [16  2 12  3  9]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.1322
Averaged Test Accurancy: 0.3371
Averaged Test AUC: 0.6778
Std Test Accurancy: 0.0903
Std Test AUC: 0.0829
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 3, 9, 12, 16]
------------------------- time cost ------------------------- 113.61906409263611

------------- Round 60-------------
> Pre-training selection: choosing 5 clients.
SELECTED INDICES:  [15  2  5 10  8]
DEBUG: About to index self.clients. Length of self.clients is: 20
> Sending global model to 5 clients for local training.

Evaluating global model before training...
Averaged Train Loss: 3.4750
Averaged Test Accurancy: 0.3416
Averaged Test AUC: 0.6485
Std Test Accurancy: 0.0949
Std Test AUC: 0.0750
--- Training 5 clients ---
> Aggregating models from 5 final selected clients.
> Selected client IDs for this round: [2, 5, 8, 10, 15]
------------------------- time cost ------------------------- 109.2076804637909

Average time cost: nans.
Length:  101
std for best accurancy: 0.0
mean for best accurancy: 0.9165861513687601
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 6590832 	Used Memory: 25.18M
-------------------------------------------------------------------------------
